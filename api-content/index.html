{"posts":[{"title":"番外篇——江恩矩阵图简介","content":" 在1892年，如果你曾作为一个商人在横跨得克萨斯州的火车上你或许会从一个高个子，瘦瘦的，年龄大约只有13岁的男孩那里买过一份报纸或雪茄烟。当你与同行的旅客谈论有关投资方面的事情时，你或许会注意到那个年轻人正在全神贯注地偷听你们的谈话。 如果你问他叫什么名字，他会告诉你他叫威廉，而且，的确他对于商品交易很感兴趣，他的父亲是安吉立纳(Angelina)县的一个农场主人，而且恰恰他所认识的每个人也是这样的。他们都很关心他们的棉花将会给他们带来的收益。如果你问小威廉长大后想做些什么？是否也想在得克萨斯州的东部耕种土地？他会说不，他没这样想过。他想成为一个交易商。你或许会说：『噢！祝你好运，小威廉 ，有一天你或许会有自己的事业，甚至会很有名。谁知道呢？没有人能知道未来。』 在火车过道上来回走过的年轻偷听者就是我们的江恩大师，威廉.戴伯.江恩。 他也许在想，真的没有人能预知未来吗？ 威廉.戴伯.江恩William Delbert Gann（1878/6/6~1955/6/14) 出生在美国德州Lufkin市郊一个种植棉花的农场。江恩自1908年在纽约华尔街重新开始从事交易，直到1955年辞世，漫长的投资生涯中，『矩阵图』一直是江恩致力使用的推算工具，堪称是江恩一生的精华，是江恩理论中最简易明确的技术分析。 一张四方形的数字图，其中竟隐含了所有金融商品的进退趋势，是的，此图可以推算所有的金融商品，及所有与数字有关的东西，当然也包括股票。 二十世纪初的世界，是江恩活跃的时代，他经过第一次世界大战，走过1929年股灾，接着经历著名的三十年代经济大萧条，及见到第二次世界大战。在这些动荡失序与经济紊乱的漫长岁月里，江恩都安然渡过，且赚到钱，并活到77岁高龄。 江恩是二十世纪初在华尔街有着神奇色彩的传奇人物，他是金融市场史上最成功的交易员之一，更是技术分析领域的超级大师、领导者。 江恩有6本着作，5本小册子，及庞大的课程讲义…… 江恩理论是什么？ 江恩发现金融市场同样受着自然法则的规范，有其振动规律。市场价格的波折、起伏不是紊乱的，而是可通过数学及时间周期来预测。因此江恩用了10年时间，创出摆动图的曲线图表之外，另以直的角度线，圆的螺旋角度，并加入时间因子注来预测市场走势。『价格的波动与时间的通过，必遵守角度的撑压关系。』这就是江恩理论 ！ 『江恩理论』的独特与神奇，即是加入时间的的运用，百年来，再无人出其右。他解开了时间价格循环、对应的秘密，这即是金融市场中自然律的『振动法则』(Law of Vibration)，并透过他多样独特的分析工具做最有效的运用。 在推展这个理论之初，1908年6月江恩回到华尔街成立他自己的经纪公司后，在1909 年10月，接受一家在二十年代初期很风行的金融杂志《报价与投资文摘》的编辑理查德德D.怀高，做专题的操作采访，这是一个由记者在现场，实际全程监看整个交易过程的采访，且期间长达一个月。这就是百年来让江恩追随者津津乐道的神奇操作！江恩在25个交易日中，进行了多空的286次操作，结果有264次获利，只有22次是亏损的，他的操作资金到月底时，暴增到百分之1000%。这不仅仅震撼了在场监看的杂志记者，这样不可思议的操作绩效，不但是前无古人，至今亦未有来者。这样的纪录也撼动了华尔街，评论家、媒体纷纷撰文报导这个开创股票分析新观念，开始崭露头角的先行者，从而开始了『江恩理论』的千秋时代。 研究技术分析的人都知道『江恩理论』（Gann Theory），不过多数人却不是很了解江恩理论，因为这部分的书与资料在国内真不是很多。所幸，拜科技之赐，我们现在可以很容易在网络上找寻到许多信息，但是找到是一回事，看懂、学习像又是另一回事。 江恩以几何、星相及数学的概念、发展出两套分析系统，都非常有效的应用在操作上，造就了江恩在华尔街辉煌、多采多姿的一生。这两套分析系统分别是江恩角及基准图。 脍炙人口的江恩角大家应不陌生，几乎在所有的分析软件中都有它，笔者这里就不赘言这部分。另一套是基准图的分析系统，在当时是江恩的特别课程，学费非常高昂，而且学员上完课后还不能向外人说，所以现在一般的江恩的书籍中是看不到基准图的介绍，这些都在江恩的特别课程教材中。笔者在1993年一个机缘中接触到这部分，当时的环境，江恩理论的数据更是绝少流通在上场上，更别说是基准图的部分了。 江恩基准图 江恩基准图包含有方的矩阵图、圆的轮中之轮与六角形、三角形，其中方形的矩阵图是所有基准图的基础。 『矩阵图』是江恩理论中最简易明确的技术分析，是江恩一直致力使用的推算工具，堪称是江恩一生的精华，江恩理论的精髓。一张四方形的数字图，其中竟隐含了所有金融商品的进退趋势 (当然也包括股票) ，此图可以说，可推算所有有关数字的东西。 美国小说家，索尔.贝娄说：『老朽的生命疲竭，而新的形式尚未出现，人们彷佛在沙漠逡巡探勘，努力找寻新的形式。』这句话用于现在的技术分析领域里，显得非常贴切。行情的变化往往于瞬息间，很多投资人每天都在猜猜看，当然，猜对了有奖！可是有多少人猜中大奖？又有多少人能连续猜对？ 任何有心于市场的投资人都知道，要想存活于市场绝非问问明牌、看看上市公司相关财务报表数据，或简单学个技术分析、画画线、瞄瞄指标就可以掌握行情，可以傲视且屹立于市场！如果这么简单人人都赚翻了，也不会猜对十次，还不够错一次大的。有一句话很好：『市场的钱赢不完，口袋里的钱却输得完。』 长久以来技术分析工作者、投资大众，不论新手老手，一直在找寻一种简单明白、快速有效的分析工具，却愈迷失在多如牛毛的技术指标、深奥的理论与复杂的线形中。尤其拜科技之赐，现在的图形分析几乎全在计算机上进行。计算机图之速度，自是手工绘图所望尘莫及的，但计算机图常见的盲点在于只能参考过去的线形，无法切划未来较长的行进方向 (边度不够) ；此外受限于计算机硬件的规格，或因软件程序功能的限制与压缩图形往往失真及变形，并不能做为推算依据。以一般技术分析软件上常使用的江恩角为例，根本形同虚设。 因为：『江恩角必需架立在矩形图上才能使用，现在的计算机图都是略长形较多，更别说这套软件的程序，也要是专为架设江恩角写的，且使用江恩独特的线形图。』现在大部份技术分析软件都不符合这样的条件，是无法作用的。许多人不知道也用得很有意思（等有了问题才奇怪江恩角不好用？），这是盘后技术分析软件该检讨的问题，也是使用者应知道的事。 其实，每一种技术分析的指标及理论，都有其学习与参考的价值，问题是绝大多数都无法提供我们对未来行情变化的肯定。哈佛工商评论 ( Harvard Business Review ) 之研究报告指出：『要做到高获利的持有股票，这类指南的正确性必须高达80%以上，可惜这些掌握市场趋势的专家们无法办到。』是的，现在普遍所使用的技术指标，确实无法达到上述目标，因为这些指针，大都只是依现在的行情变化而被动的变化。难道技术分析的领域里，没有一种指标是超前的、确定的？ 不！不是这样的，您要相信，当出现一个问题，就有一个解决的方法；有一个疑问，就有一个答案。天地之间，一定存在一种均衡的力量。我们现在不能突破困惑，那只是我们还没发现突破的缺口，绝不是不存在！在乍逢江恩理论之时，就有这样的感觉，这分析工具绝对是一种新的生命形式。我在这些年间一直有一个疑问，『矩阵图』这么简单的东西，为什么相关数据如此欠缺？为什么没有广泛流通？我最后确定的答案： 『就是太简单了！』 我们从懂事开始，从懂得分辨善恶好坏开始，从懂得思考开始，我们就随着成长所增长的“智慧”而愈复杂起来，简单的东西反而是不予置信、不屑一顾的。在金融市场上，也是有许多人不相信有这么简单的分析工具，于是视若无睹，束之高阁。我能有机会写这本书，该要感谢那些专注于江恩理论中较复杂面的研究者，因为他们汲汲于较复杂的层面，无暇兼顾全面，才能让我有机会将最简易的『江恩矩阵图』递交给有缘者，给有心凭持着技术分析以屹立于金融市场的新生命，及坚执要找寻到，最终极的技术分析的您。 自然学派的分析认为：『大自然的一切变化，大自新宇宙的形成、星体运转，小至环境、个人，或高昂或低沈，皆有其脉络依循。任何人为的市场变化，无论盛衰荣枯、起伏变化，均在大自然律动中，以有形确定的方向行进，不会在毫无征兆、无预警的情况下，产生不规则的乱象。』 『矩阵图』的应用即基于此等理论，将各个不规则的曲线简化成数字，克服了线形和指标中的盲点，从而在规律的脉动中，克服心理弱点、克服人为的陷阱，看到方向。在预警的征兆中提醒您及时动作，这些在矩阵图中都可以轻易做到。 只须观察矩阵图角度区域数字的对应现象， 就可轻易的分析商品趋势，且明确显示未来价位区。 没有比这还要轻松简单的技术分析了。 准备好进入『江恩矩阵图』神妙的世界了吗？ 准备好开启新的生命了吗？唯一的规则，请带着最简单的心、最单纯的思维。 永远不要忘了『最简单的道理，才是世间最伟大的真理』。 请对照附图 此一矩阵图上面有四条线分别为： 左右两条对角的交叉线 (即江恩成名的45度角) 一条直的垂直线 一条横的水平线 四条线交集的中心『 1 』即是数字的起点称为『基数』。 『 1 』为基数起点，呈螺旋状，从九点钟位置由左至右顺时针方向旋转2、3、4、5、6、7、8、9、10、11、12 …… 这四条线将图分成：四个正方区域 八个等腰三角形区域 两条对角的交叉线：为支撑及压力区 (以下简称角线) 垂直线和横的水平线：为多空交战区亦为动能区 (简称十字线)。 ★ 请注意‧刚好位在这四条在线的每一数目字， 它们都是矩阵图中相当重要的关键数字。 A、角线 (由左下角至右上角) 361‧289‧225‧169‧121‧81‧49‧25‧9‧1‧5‧17‧37‧65‧101‧145‧197‧257‧325 B、角线 (由左上角至右下角) 307‧241‧183‧133‧91‧57‧31‧13‧3‧1‧7‧21‧43‧73‧111‧157‧211‧273‧343 C、水平线 (由左至右) 298‧233‧176‧127‧86‧53‧28‧11‧2‧1‧6‧19‧40‧69‧106‧151‧204‧265‧334 D、垂直线 (由上至下) 316‧249‧190‧139‧96‧61‧34‧15‧4‧1‧8‧23‧46‧77‧116‧163‧218‧281‧352 以上这些数字，就是在矩阵图上进行演算的基础。 这些数字在各个角度区间产生互相吸引或排斥的力量！这样互相吸引、排斥的现象，即是造成上涨、下跌的力量，此种关系明确反应于四条在线，故可简单的循线推算每一只股票近、远期的价位，尤其是可简易推算中长线趋势，我们称为『大数推算』，这在下一章中会做详细说明。 『矩阵图』之技术分析，其异于市场上所习用的各项技术指针，与传统曲线的线路图之处，在于矩阵图是以角度上的数字显示路径。以上所有的数字永远是固定的、顺序的、规律的排列。我们才可以清楚的分析股价的未来行进路径，不会迷失在各种复杂的线形里。 市场行情的变化，皆在一瞬间产生，股价上下波动的同时，亦在波动我们的情绪和判断的思路。我们被这些不能自主的变化影响，因此时而疑惑犹豫，时而肯定乐观。在我们情绪低落懊悔时，或喜悦振奋的同时，整个市场的多空气氛也是如此动荡，因而更激励股价的加速起伏，这就是股票市场多空争战曲折、动人之处。 行情是在瞬间发生的。但是我们要记得瞬间发生的动能，来自之前所累积的能量。之前，是说一分钟之前、是昨天或上个月之前；也就是说，这一分钟的价位，在前一分钟已有迹象显示；今天的价位，在今天之前已有征兆显示，波段的走势是更大动能的蓄积。问题是，我们如何在行情变化之前，从征兆里预测可能的波动范围？ 简单一张数字图，就可堪破所有商品玄机！我时时感念江恩为我们留下的宝贵资产。身处金融商品市场十数年，眼看弱势之投资人，及有心投入市场的新鲜人，苦苦啃读各类投资书籍，费心、尽力学习最好的技术分析。听演讲、访明师，但是大部份人都持续在做事倍功半的事，不能真正拥有自己的利器。我深深体会！在这非理性又无情的市场中，没有属于自己的东西，是很难长久生存的。名嘴名师、基金经理人如此，法人大户、投信操盘、股票营业员如此，您也是如此，毫无侥幸可言。 因此我不敢藏私。在进入如何使用『矩阵图』之前，要请您注意，若已学习过其他技术分析，在学习『矩阵图』时，请把以前所学的分析方法先放置一旁，以“空杯”的心态进入，才会有干海绵强力吸收的效果，才不致浪费时间在各种分析的比较上。等掌握『矩阵图』的使用，还有兴趣再与别的分析法去做比较时，您将知道它和别的理论和指标是兼容的，却简易得太多了。 最后，当您对以前种种学习过的技术分析顿足叹息，或对现在『江恩矩阵图』的种种奥妙，点头微笑之时，请您也怀着对江恩感激的心。在这金融市场中百余年来，还有谁深研广究一种理论长达十年之久，在确定、掌握要诀后，才开始运用在实战操作上？而后又著作、编写教材长达四十年以上，来告诉投资人他如何洞悉行情的？又有谁肯在赚取了相当的财富后，还愿意告诉投资人他是用什么分析方式从市场赚到钱的？而不仅仅只是陈述一种操作理论而已，是真实的从市场赢得财富，这个人，是江恩。 矩阵图2和矩阵图1是完全相同的图形，差异在介于角线与十字线之间的『辅线』。矩阵图2是我们平常使用最频繁的原图，注意『辅线』的使用功能。 辅线有四条线其作用为，分隔过大区域。 因为矩阵可至无限大，在正常状态下，数字至361是标准图形。 超越361以上时，要用辅线做为角线与十字线之间的『动能观察区。』请看『矩阵图2』，在右上角以785 ~ 799为例，中间的792即为动能缓冲观察区。 数目越过785，下一关卡点是799，位于中间辅在线的是792，观察当数目越过785到达792时的力量是否充沛？是否能够继续上攻，或者须要换手、休息？这里的换手、休息并非回调，通常是越过785后应以785为支撑；抑或越过785后直上799，碰压力后以792以上为小型的支撑区，如此则表示力道强劲，有再冲高能力。 另一种相反的情形是，突破785后并未到792就回落。在技术上就可以判定这785是站不稳的，因为突破一个压力时，上冲的力量，必须足够到达动能缓冲区，若只是通过角度而已，并非有力突破，我们就可判断这是一个短线高点，而采取应有的动作，因此能让我们预防假突破与假跌破现象。这『辅线』的动能缓冲观察区观盘法，您要花一些时间做验证，才会有较深的体会 ( 可先在实时盘上对照验证 )。 如何以一张图表来推算所有金融商品的秘诀 我们知道各商品的价值不同，其价位表现亦不同，指数有到5位数以上的，股价有个位数的，外汇有小数点，如何在一张图表上统一使用？ 诀窍就是将数字缩小、放大百分比来使用。 基本上我们最常使用的比例依序是 100:1、10:1及 1:1。 使用于指数时须缩小百分比 ( 过小数字可放大百分比 ) ，否则数字图形过大使用会不方便。所附之『矩阵图 2』数字才961点，已这么大张。加权指数高点有10,000点以上，想想这么大一张图怎么携带？我曾做过100cm×100cm数字达9,800的大型图，张贴在墙壁上倒像是挂图。 (实际上是用在时间计算上的) 以大多数的商品来说，这961点的矩阵图足够正常使用了。 缩小百分比： 小數点无条件舍去 A 、上证指數6124 缩小百分比10:1 约为612 缩小百分比100:1约为61 B 、深圳成指19600 缩小百分比10:1 约为 196012 缩小分比100:1约为 196 C 、道琼指數18351 缩小百分比10:1 约为1851 缩小百分比100:1约为183 放大百分比： A、平安银行股价5.05 可放大百分比1：10约为 50 B、万科股价 3.12 可放大百分比1：10约为31 C、浦发银行股价6.41 可放大百分比1：10约为 64 缩小及放大百分比100：1与10：1，在矩阵图上的落点，于角度在线是看不出对应关系；但，仍可在角度在线看到分别的对应及撑压关系。使用观念在于各商品的数字，其所对应的撑压是独立的，其循环性亦是独立的。或许有时我们会发现，商品与商品之间的循环或走势，有其相关性的连结，但其特性仍是各个独立的。也就是说，当我们使用100：1时，其走势的撑压及对称是一种关系；使用10：1时又呈现另一种关系，它们不会互相干扰，所以我们可以分开或放在一起使用。当然，在做一较长趋势的判断时，我们通常是先看『大数』 ( 1~361基础角度线的使用 ) 。大数一般以100：1的使用已足够；再以10：1做短期的撑压推算，这部份我们会在后面做说明及推演。 放大、缩小百分比的应用，主要是在矩阵图上有更大的翱翔空间。如果任何商品都以1：1来做推算，也就是一格一点的看，那这张矩阵图得有多大？请记得，除了时间推算之外，所有的价格（指数）的推算，我们都可以用增减百分比的方式来做最好的使用。尤其是现在的鸡蛋水饺股就是用1：1也没办法看，但若以增大百分比的方式，它又是一尾活龙。 如某股2.57元，在矩阵图上放大百分比为257，这价位在A3角，顺时针往前看为上涨压力，下一角线是A4角的273。好，现在您是不是很轻松的就可以知道它短线在2.73元有压力。看远一点就再往下一角线看，下一角线为A1角的289，以A3角位置直接看A1角，就是一个180度的角线对角线（257~289，约0.3元）。 下跌呢？从257的A3角往A2角方向移动，A2角位置是241，就是2.41元有支撑。如果也以角线对角线来看，还是直接看A1角的225，那2.25即为一个对称角度的支撑。这就是百分比增大时很好使用的例子，其观盘法及角度线的使用技巧在后面都会做更详尽说明。以下为矩阵图简单看线形使用之角度线代号。从左下角开始，顺时钟方向。 角度线代号： 角线为A1 - A2 - A3 - A4 。 辅线为B1 - B2 - B3 - B4 - B5 - B6 - B7 - B8 。 十字线为C1 - C2 - C3 - C4 。 基础看图法 基础看图法包含两大部份： A、大数推算--中长线的趋势推算法 主基数推算：以历史大波段高、低点为基点的对应推算。 次级/次要基数推算：以次级波段高、低点为基点的对应推算。 B、基础角度线推算--短中线、波段的推算法 整个基础角度线的使用有三大项： 大数趋势分析后，分割段落区间的使用 16条线都要看 短波段及波段的推算使用 角线之前的撑压观察区 角线与角线之间的关系 ","link":"https://blog.elex.vip/post/fan-wai-pian-jiang-en-ju-zhen-tu-jian-jie/"},{"title":"番外篇——成功率100%的通达信指标公式，你敢相信吗？","content":" 前几天，有人问能不能把通达信副图公式改成选股公式。我把指标公式加载到副图（如上图），发现这个指标真是牛了，成功率100%，发出信号的之后两天，总是能涨。难道找到了交易的圣杯，如果按照这样的成功率，即使每次盈利只有1%，不出几年就可以脚踢巴菲特，拳打索罗斯了。真的有这种好事吗？ 代码如下： 仔细研究了这段代码，发现上面的几句代码都是废话，删除对交易信号并没有影响。此外这几句废话，看起来很眼熟，接下来就来分析一下。 一、通达信指标公式代码分析 首先前两句，其实是获得MACD的DIF和DEA值，只不过参数改了、变量名重新命名了而已。可以打开通达信上自带的MACD指标对比一下。（MACD指标代码如下图）这两句都是冒号等于（:=），不会在副图上画出来。再看变量名“暴好用”和“指标公式”，后面的代码中也没有用到，所以这两句代码可以直接删除，对指标公式并没有任何影响。 2. 再看接下来三句，又是非常眼熟，其实是KD指标（代码如下图）。把KD指标默认的参数换成了(8,2,2)，我们也重新设置参数，设置之后，对比发现，完全一样。变量名BBSS1、BBSS4、BBSS5后面的代码也没有用到，对产生的信号没有影响，这三句也可以直接删除。 3. 再看最后一句，DRAWTEXT在之前的文章讲过了，是标记函数，在产生信号的地方写文字，对信号的产生没有影响，可以直接删除这句代码。 删除没用的代码，只剩下三句代码起作用。很不幸的是，这三句代码只是用来忽悠人的。 “暴利”这一句还可以继续精简，把精简的指标加载到副图，发现结果是一样的。当然这个变量名“暴利”有点讽刺。 接下来看看这个指标是如何忽悠人的，下面对这三句核心代码进行解析。 二、核心代码解析 BBSS6:=CLOSE/REF(CLOSE,3)&gt;=1.1;，这一句表示当前的收盘价除以三天前的收盘价大于等于1.1，也就是说最近三天的涨幅大于等于10%，如果这个条件成立，BBSS6的值就是1，否则就是0； BBSS7:=BACKSET(BBSS6,3);，这一句用到了BACKSET，BACKSET是未来函数，BACKSET(BBSS6,3)表示BBSS6为1时，把最近三根K线对应的BBSS7的值设为1。（为了避免和最近三天涨幅大于等于10%混淆，这里把最近三天换成最近三根K线） 上面提到过，最近三天涨幅大于等于10%，BBSS6的值才是1，只会产生一个信号。但是现在经过给BBSS7赋值，只要BBSS6满足条件，就可以让最近3根K线产生3个信号。（如下图） 3. BL:BBSS7 AND COUNT(BBSS7,3)=1;，这一句中COUNT(BBSS7,3)=1，就是统计最近3天满足BBSS7的天数为1。这样限制之后，只会在最近三根K线中的第一根产生信号。 最后总结一下，这个虚假的信号其实是建立在最近三天涨幅大于等于10%这个已经发生的事实之上，然后往前推两天发出信号。这有点像什么呢？就像我们交易的过程中，发现这只票已经涨了很多，然后我们再找各种理由分析这只票。因为已经涨了，我们无论用什么方法来分析都是对的，这就叫后见之明吧。 通达信指标公式中如果使用了未来函数，在窗口的左下角会提示“用到未来数据”。对于成功率很高的指标公式，大家在使用时不要被结果蒙蔽了。 ","link":"https://blog.elex.vip/post/fan-wai-pian-cheng-gong-lu-100de-tong-da-xin-zhi-biao-gong-shi-ni-gan-xiang-xin-ma/"},{"title":"第二十八篇——一通达信板块函数INSUM、BLOCKSETNUM简介以及应用（从零起步编写通达信指标公式系列）","content":"有人问：统计指数成分股的收盘价高于20日均线的数量占比（0%~100%），如何编写成副图指标？ 这种指标公式属于代码不多，难度不小的类型。如果平时编写板块方面的指标比较少，相关板块函数不常用，那需要花点时间研究。 一、所需函数 1、STKNAME 含义：获取品种名称 2、HYBLOCK 含义：获取品种所属行业板块 3、BLOCKSETNUM 含义：统计板块的成分股数量 使用方法：BLOCKSETNUM(板块名称) 4、INSUM 含义：获得板块成分股对应指标的计算值 使用方法： INSUM(板块名称,指标名称,指标线,计算类型) 板块名称：支持系统自带的板块，也支持自定义板块。除了支持字符串，还支持上面介绍过的STKNAME、HYBLOCK这样的变量来获取板块名称，当切换查看的板块时，指标的数据会自动变化。 指标名称：支持系统自带的指标，也支持自编指标 指标线：1表示指标的第一个输出值，2表示指标的第二个输出值，以此类推 计算类型：0表示累加，1表示平均数，2表示最大值，3表示最小值 举例：INSUM('半导体','MACD',3,0);，表示半导体板块中所有成分股的MACD指标第三个输出即MACD值的累加值。（如下图画线处，第一个输出值是DIF，第二个输出值是DEA，第三个输出值是MACD） 二、指标编写 思路： 统计指数包含的成分股总数 统计指数的成分股中收盘价高于20日均线的数量 然后求占比 1、引用公式 在步骤2中，用到INSUM函数，INSUM函数需要用调用指标来计算收盘价高于20日均线的数量，但是系统没有自带这样的指标，所以需要我们自己新建，源码如下： 公式名称为“高于20日均线”，在主指标公式中会用到这个名称，如果修改了名称，需要在主公式中同步修改。 2、主公式 引用公式保存之后，再新建主公式，源码如下： 以沪深300、中证500为例，效果如下图。 沪深300指数 中证500指数 ","link":"https://blog.elex.vip/post/di-er-shi-ba-pian-yi-tong-da-xin-ban-kuai-han-shu-insumblocksetnum-jian-jie-yi-ji-ying-yong-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第二十七篇——一阳穿三线选股指标公式，简单却实用（从零起步编写通达信指标公式系列）","content":"内容提要：一阳穿三线，顾名思义就是一根阳线上穿了三条均线。看图比较直观，如下图箭头处的K线。 一、一阳穿三线选股指标公式 一阳穿三线选股指标公式编写思路还是比较简单的，首先需要定义三条均线，然后比较得出这三条均线的最大值和最小值，最后限定K线的收盘价大于均线最大值，K线的开盘价小于均线最小值，这样就实现了K线的实体部分上穿了三条均线。 二、信号过滤 通过查看产生的信号，可以发现当三条均线非常接近的时候，一些小阳线也满足条件，这不是我们想要的。（如下图红色箭头处） 可以在公式中，增加限制阳线实体涨幅的条件，对信号进行过滤。比如阳线实体涨幅大于3%，即C/O&gt;1.03，即可过滤小阳线。这个涨幅可以根据自己的要求自行设定。 三、主图叠加指标公式 上面的公式可以保存成为副图指标，也可也直接保存为条件选股公式。如果要加载到主图上，需要做一些修改。均线需要写为:，这样才能在主图上显示均线。在用DRAWICON函数，把信号标注出来。 为了在主图显示，下图中红色箭头处做了修改。画线方法选择“主图叠加”。 ","link":"https://blog.elex.vip/post/di-er-shi-qi-pian-yi-yang-chuan-san-xian-xuan-gu-zhi-biao-gong-shi-jian-dan-que-shi-yong-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第二十六篇——均线粘合突破选股指标公式怎么写？（从零起步编写通达信指标公式系列） ","content":"内容提要：今天给大家介绍如何编写均线粘合突破选股指标公式，其实本文内容并不局限于突破，而是均线粘合加启动点。首先需要找到均线粘合，然后对信号进行过滤，再加上一些条件，找到启动点。 一、均线粘合 均线如果没有特指，一般是MA简单移动平均线，MA(X,N)为X的N日简单移动平均。以MA5、MA10、MA20、MA30四条均线为例，随着行情震荡，这四条均线越来越接近，表现为均线粘合。编写均线粘合的思路是如果这四条均线的最大值与最小值能约束在一个很小的范围内，即可找出均线粘合。 这里以最大值与最小值之间的幅度为1%举例，即M:=0.01;，如果觉得条件太苛刻，可以自行修改。N1、N2、N3、N4为均线的参数，在上面的公式中分别为5、10、20、30，均线参数也可以自行修改。加载到副图，可以看到信号太多了，后面会介绍怎么过滤。 之前有人问，五条均线粘合怎么写。我们先来看四条均线，以MAX为例，四条均线比较出最大值，可以先进行两两比较，最终得到最大值。 比较得出最大值有两种写法，结果是一样的： 第一种，先比较MA1和MA2，得到的最大值再与MA3比，得到的最大值再与MA4比，最终得到这四条均线的最大值。 第二种，先比较MA1和MA2，MA3和MA4，分别得到最大值，再进行比较，最终得到这四条均线的最大值。 五条均线可以依葫芦画瓢，套娃就行了。 二、信号过滤 上面介绍的均线粘合公式，初始条件比较简单，导致信号太多，如果有些信号明显不是我们想要的，可以过滤掉。比如如果不想在下跌趋势出现信号，可以加一条大周期均线，下跌趋势行情一般会在大周期均线下方运行，过滤掉即可。当然这样会过滤掉一些机会，看自己的取舍吧。我这里加了一条MA120均线，收盘价在MA120均线上方才提示信号。下图对比发现，对于明显的下跌趋势，过滤效果还是不错的。此外可以对信号进行复盘，进行进一步过滤。 三、寻找启动点 找到均线粘合的震荡行情并不是我们的终极目标，我们希望找到均线粘合之后行情的启动点，可以通过放量、大阳线、突破前高、均线拐头向上、均线发散等条件来找到。但是要注意，需要先找到均线粘合，再找到启动点，均线粘合和启动点一般不在同一天。 以下图为例，箭头处的K线突破了前高，但是此时却已经不满足均线粘合的条件，如果用AND让均线粘合和突破前高同时成立，那么就不会出现信号。用COUNT函数统计最近几天出现过均线粘合，并且当天突破前高，这样可以出现信号。 下面就把这些条件综合起来，写出均线粘合突破选股指标公式（均线粘合+启动点）： 公式中写了A1、A2、A3、A4、A5、A6、A7七个条件，写这么多条件只是为了拓宽大家的思路。如果自己编写指标，没必要使用这么多条件，条件太多可能会漏掉一些不错的信号。可以从中选择几个条件或者自行设置条件。 ","link":"https://blog.elex.vip/post/di-er-shi-liu-pian-jun-xian-nian-he-tu-po-xuan-gu-zhi-biao-gong-shi-zen-me-xie-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第二十五篇——均线多头排列选股公式，选出均线多头刚起步的标的（从零起步编写通达信指标公式系列） ","content":"内容提要：均线多头排列选股公式总体还是比较简单的，写出均线，然后比较大小。为了做成选股公式，选出均线多头刚起步的，还需要做一些修改。另外为了方便自定义均线条数以及均线参数，介绍了两种改写方法。 一、均线多头排列选股公式 比如5日、10日、20日三条均线多头排列 从上图可以发现，满足均线多头排列的周期数比较多，两个黄色箭头之间的周期都满足。如果用来选股，结果太多。选股一般只需要选出均线多头刚起步的即可，也就是说选出第一次满足均线多头排列的，因此需要加上一个限制条件。 以上图为例，第一次满足均线多头排列条件的时候，PL从0变成1，之后的几个周期都满足均线多头排列，所以PL一直是1。利用CROSS(PL,0.5)，PL从0变成1的时候要上穿0.5，这样就可以选出第一次满足均线多头排列。 二、自定义均线条数以及均线参数 上面以三条均线举例，有的新手可能会问，四条均线多头排列怎么写，五条均线多头排列怎么写。另外以前为了方便举例，在指标公式编写过程中，把参数都固定了。比如上面的公式中，5日、10日、20日均线直接写出来了，如果想改为其他均线，修改也不方便。针对这两个问题，接下来介绍两种方法，方便进行自定义。 1、设置参数 第一种方法是设置参数。均线写成MA1、MA2、MA3，这样想用几条均线就写几条，对应的参数就写成N1、N2、N3，比如MA1:=MA(C,N1);，参数在公式编辑器中设置，如下图。最小最大是设置参数的取值范围，缺省是设置默认参数。比如N1最小1，最大1000，缺省5，意思就是N1的取值范围是1——1000，N1如果不手动调整参数，默认就是5。这样对应的MA1均线就是5日均线。 四条均线多头排列，加一条均线MA4即可。五条均线以此类推。 2、参数写在公式开头 第二种方法，把参数写在公式开头。在指标公式编辑器上方设置参数不太方便，新建公式的时候需要手动输入。比如大家想复制公式源码，还要自己手动输入参数，有点麻烦。在公式开头写出参数，后期维护也比较方便，可以直接修改。 以四条均线为例，五条均线以此类推。 为了方便展示，文章中的源码保存为副图指标。但是这些源码可以直接保存成为均线多头排列选股公式。 ","link":"https://blog.elex.vip/post/di-er-shi-wu-pian-jun-xian-duo-tou-pai-lie-xuan-gu-gong-shi-xuan-chu-jun-xian-duo-tou-gang-qi-bu-de-biao-de-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第二十四篇——如何编写均线斜率大于45度的公式（从零起步编写通达信指标公式系列） ","content":"内容提要：今天介绍两个与角度、斜率相关的通达信函数ATAN、SLOPE，并探讨编写均线斜率大于45度的通达信指标公式。这里说的均线斜率，实际上是均线的角度。 一、ATAN函数 含义：求反正切值 使用方法：ATAN(X)获得X的反正切值，求得的反正切值是弧度制，为了方便理解，一般会转换成角度制。1弧度=180/π，约等于57.3度。π约等于3.14115926，编写指标的时候，换算一般写为180/3.14115926。 根据斜率的定义，直线对x轴的倾斜角的正切值tanθ为该直线的斜率。如果我们知道了正切值tanθ，通过反正切函数ATAN就可以求得θ的角度。θ角度的取值范围在（-90°，90°）度之间。 但是在交易软件上，x轴是周期，y轴是价格，x、y值单位不同，没有可比性。我们通过下面两张图，可以发现问题所在。对于同样一段行情，当这一段行情放大的时候，我们一眼看上去，均线角度可能是45°。如果把这一段行情缩小，均线的角度发生了明细的变化，显然大于45°。这样均线的角度就没有意义，因为会随着K线图的放大缩小而产生变化。 使用通达信编程语言编写均线的角度，常见的做法是用均线的涨跌幅来近似替代正切值tan， ZF:=(MA5/REF(MA5,1)-1)*100;，当均线涨幅为1%，ZF等于1，这时候求得的角度JD就是45度。但是每天的涨幅是有极限的，以主板涨停10%为例，即使连续涨停，ZF的最大值也就是10，计算得到JD最大值84.289。 把指标加载到副图进行验证，可以看到JD的最大值基本上在80多，确实如我们所料。 这样，均线角度大于45度的公式就可以写出来了。 二、SLOPE函数 除了用ATAN来计算角度、斜率，还有另外一个函数SLOPE。 使用方法：SLOPE(X,N) 获得线性回归斜率 线性回归斜率，可以简单理解为根据模型拟合出一条直线，计算这条直线的斜率。SLOPE(MA5,5)就是取最近5日的MA5值，然后拟合出直线，计算斜率。因为取的最近5日，所有反应会相对迟钝，5日均线刚刚向上拐头的时候，计算的斜率可能还是负的。 这个SLOPE函数感觉有问题，计算出的斜率竟然和股价有关系，股价高计算出的斜率数值比较大，股价低计算出的斜率数值比较小，这样没有统一的比较基准，使用起来很不方便。如果用来表示均线是向上还是向下还可以用用，但是如果用来计算均线的角度，那就用不了了。 当然我可能对这个函数有误解，欢迎提出问题，交流探讨。 ","link":"https://blog.elex.vip/post/di-er-shi-si-pian-ru-he-bian-xie-jun-xian-xie-lu-da-yu-45-du-de-gong-shi-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第二十三篇——通达信自动提示穿头破脚K线组合形态（从零起步编写通达信指标公式系列）","content":"内容提要：今天给大家介绍一个比较应景的K线组合形态——穿头破脚。 一、穿头破脚介绍 穿头破脚K线组合形态由两根反向的K线组成，第二根K的实体部分要完全覆盖第一根K线的实体部分。可以分为顶部穿头破解和底部穿头破脚两类。（如下图） 穿头破脚通常被视为反转信号，表明潜在的趋势变化。如果穿头破脚出现在上涨趋势之后，它可能表明上涨即将结束，下跌即将开始。类似地，如果穿头破脚模式出现在下跌趋势之后，它可能表明趋势正在反转，上涨即将开始。 在利用穿头破脚K线组合形态分析行情时，可以考虑以下几点： 穿头破脚出现的位置：如果穿头破脚出现在一个趋势的尾部，它可能是一个反转信号；如果出现在一个震荡市场中，它可能是一个突破信号。 穿头破脚K线的大小：如果穿头破脚第二根K线比第一根更大，则可能表明趋势反转的力量较大。 与其他技术指标的结合使用：穿头破脚应与其他技术指标结合使用，如成交量、均线等，以确认潜在的趋势变化。 二、穿头破脚通达信指标公式编写 穿头破脚思路： 如果K线太短小也没有意义，所以有必要给K线的幅度做一些限制。这里限制第一根K线幅度大于3%，第二根K线幅度大于4%。另外第二根K线实体部分要覆盖第一根K线的实体部分。 上面的写法没有区分底部穿头破脚和顶部穿头破脚，如果想做区分，可以分开写。公式如下： ","link":"https://blog.elex.vip/post/di-er-shi-san-pian-tong-da-xin-zi-dong-ti-shi-chuan-tou-po-jiao-k-xian-zu-he-xing-tai-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第二十二篇——「硬核讲解」通达信如何跨周期引用均线？（从零起步编写通达信指标公式系列）","content":"内容提要：本文主要介绍了编写通达信跨周期引用均线指标公式需要用到的方法，以及在固定位置写文字、数字需要使用的函数，并进行综合运用编写指标公式。 这几天有人问能否实现主图标记不同周期均线价格并按大小实时排序，比如显示60分钟，120分钟，日线，周线，5/10/20/30/60周期均线价格并自动排序，或者能否实现在主图右侧单独标记出不同周期价格点位，而不需要显示出跨周期均线以免主图太复杂。 针对这个问题，主要解决思路是实现跨周期引用均线数据并且在主图右侧标记点位，不然图上画出很多均线，完全看不清。 实现这个思路需要用到两点知识：第一点跨周期引用均线；第二点在主图右侧标记点位。 一、通达信跨周期引用均线 通达信跨周期引用有两种方法： 1. 直接用符号#改变周期，但是这种方法只适合高(HIGH)、开(OPEN)、低(LOW)、收(CLOSE)等基本数据，而且只能小周期引用大周期。 2. 调用公式获取其他周期的数据，也是用符号#改变周期。这种方法可以引用大周期，也可以引用小周期。可以引用的周期为：MIN1，MIN5，MIN15，MIN30，MIN60，DAY，WEEK，MONTH（分别为1分钟，5分钟，15分钟，30分钟，60分钟，日线，周线，月线）。 根据需求，我们用第2种方法。把主周期定位在日线，在日K线图上，我们引用大周期——周线图的5/10/20/30/60这5条均线数据，以及小周期——60分钟图的5/10/20/30/60均线数据。 引用小周期要注意，需要用通达信的“盘后数据下载”把小周期的数据补充完整，不然出不了结果。 二、在主图右侧标记点位 在主图右侧标记点位，其实就是在固定位置显示文字、数字，这需要用到DRAWTEXT_FIX、DRAWNUMBER_FIX这两个函数。 在《第十六篇——学会标记函数，简单实现通达信指标公式做标记（从零起步编写通达信指标公式系列）》这篇文章中已经介绍过DRAWTEXT、DRAWNUMBER这两个函数，分别用来写文字、写数字，可以根据设定的参数来写，比如在高点（HIGH）或者低点（LOW）位置处写文字、数字，位置会随着当下的价格变化，比较灵活。而DRAWTEXT_FIX、DRAWNUMBER_FIX多了一个FIX，FIX在英文里有“固定”的意思，可以实现在窗口的某个固定位置写文字、写数字。 1、DRAWTEXT_FIX 含义：在固定位置写文字 使用方法：DRAWTEXT_FIX(COND,X,Y,TYPE,TEXT)，满足COND条件时，在当前窗口内(X,Y)位置写文字。TEXT为文字的内容，X,Y可以理解为比例坐标，TYPE为0是左对齐，为1是右对齐。 为了方便理解X,Y坐标的含义，可以看上图。左上角是0,0，左下角是0,1，右上角是1,0，右下角是1,1，如果X、Y都是0.5，那就在窗口的中间位置。 如果还不理解，可以把下面五句代码分别加载到主图上看一下，看这个“牛”字显示在哪里。注意，在公式中文字要用英文单引号。 显然，要实现在右上角写文字，那X等于1或者接近于1，Y等于0或者接近于0就可以实现。 2、DRAWNUMBER_FIX 含义：在固定位置写数字 使用方法：DRAWNUMBER_FIX(COND,X,Y,TYPE,NUMBER)，满足COND条件时，在坐标X,Y位置写数字NUMBER，TYPE为0左对齐，为1右对齐。 和DRAWTEXT_FIX用法差不多，就是把文字换成了数字，这里就不详细讲了。 三、通达信跨周期引用均线指标公式编写 首先看一下效果图（如下图），指标公式内容就不详细讲解了，思路上面已经讲过。源码看起来很多，但是大部分是用来调整位置，使指标公式显示效果更佳美观而已。核心还是跨周期引用周线和60分钟线的5/10/20/30/60均线，然后在日线图上显示。 先把下面5条均线保存为公式名称为MAJX的指标，后面新建的一个指标公式，需要引用MAJX这个指标公式。 ","link":"https://blog.elex.vip/post/di-er-shi-er-pian-ying-he-jiang-jie-tong-da-xin-ru-he-kua-zhou-qi-yin-yong-jun-xian-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第二十一篇——MACD与KDJ合二为一指标公式怎么编写？（从零起步编写通达信指标公式系列）","content":"内容提要：在编写MACD与KDJ合二为一指标公式之前，先来了解一下技术指标共振。常见的技术指标共振有三种类型：单指标多周期共振、单指标多级别共振、多技术指标共振，今天主要介绍第三种。 多技术指标共振是指多个技术指标显示出相似的趋势或信号，这通常被视为市场趋势或价格变化的信号，并表明市场可能出现更大的变化。通过寻找多技术指标共振的信号，提高成功率，以便做出相对明智的交易决策。但是要注意，多技术指标共振并不是一定可靠的，有时技术指标可能会出现逆势信号。因此，对于使用技术分析进行交易的人来说，要知道指标有一定的成功概率，不能保证做到盈利，需要结合交易系统、资金管理等进行综合决策。 MACD指标和KDJ指标是比较常用的指标，尤其MACD，基本上交易软件副图都是默认使用MACD指标。 MACD指标有三个输出变量，DIF（快线）、DEA（慢线）和MACD柱线，另外还有一个在MACD的公式里没有明显体现，但是却非常重要的0轴。下图为通达信自带MACD指标公式，默认参数（12,26,9）。 KDJ指标也有三个输出变量，K（快线）、D（慢线）和J（敏感线）。下图为通达信软件自带KDJ指标公式，默认参数（9,3,3）。 今天主要利用MACD与KDJ的金叉共振，在看盘界面发出信号或者选股。MACD金叉其实是DIF、DEA金叉，KDJ金叉为K、D金叉。 总体来说还是比较简单的，MACD和KDJ的源码照抄，参数就用默认参数。分别写出金叉条件，用AND连接就行了。如果想做成MACD与KDJ合二为一指标公式在副图上显示，两个指标会比较杂乱，可以只显示其中一个指标就行了，另一个不显示。我这里是只显示MACD。此外可以给技术指标加上提醒，方便观察信号。 平时我们看盘可以发现，MACD的0轴类似于主图的MA60均线，可以看到K线在MA60上方，DIF基本上也会在0轴上方，虽然不完全同步，但是可以作为参考。（如下图）如果不想逆势在MA60下方做交易，可以再加上限制条件DIF&gt;0，就可以过滤掉MACD零轴下方的信号。 ","link":"https://blog.elex.vip/post/di-er-shi-yi-pian-macd-yu-kdj-he-er-wei-yi-zhi-biao-gong-shi-zen-me-bian-xie-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第二十篇——通达信自动提示启明星、黄昏星K线组合形态（含指标公式代码）（从零起步编写通达信指标公式系列） ","content":"内容提要：本文主要介绍了启明星（早晨之星）和黄昏星（黄昏之星）K线组合形态的概念以及启明星和黄昏星通达信指标公式的写法，并设置K线颜色，添加文字标记。 一、启明星（也称早晨之星） 启明星K线组合形态是一种反转信号，出现在下降趋势或者回调中，由三根K线组成。 第一根K线是大阴线，反映出行情强劲的下跌。 第二根K线跳空低开，是一根实体短小的K线，反映出行情的犹豫或停滞。 第三根K线是一根大阳线，反映出行情的反转。这个K线组合形态之所以被称为启明星，是因为第三根K线代表反转，看起来像在黑暗之后升起的晨星。 我们想在图上第三根K线出现时选出股票，第一根第二根第三根这样的说法我们知道是什么意思，但是通达信软件不知道，需要用软件能理解的语言来写指标公式代码。所以编写时，图上的第一根K线是2日前，用REF(X,2)来表示；图上第二根K线是1日前，用REF(X,1)来表示。 第一根（2日前）K线是大阴线，这里把大跌5%以上定义为大阴线，即REF(C,2)/REF(O,2)&lt;0.95。 第二根（1日前）K线跳空低开，所以第二根的开盘价小于第一根的收盘价，即REF(O,1)&lt;REF(C,2)；实体短小，这里定义为小于3%，阳线、阴线都可以，即ABS(REF(O,1)-REF(C,1))/REF(C,1)&lt;0.03;。 第三根（今天）K线是大阳线，即C/O&gt;1.05；另外需要筛选掉一些不符合要求的，第三根（今天）的收盘价要高于第一根收盘价，即C&gt;REF(C,2);。 另外为了让K线更醒目，可以给K线涂上颜色，也可以加上文字提醒。 代码如下： 启明星K线组合被认为是反转信号，因为它表明下降趋势或者回调可能即将结束，但是要注意，启明星K线组合仅仅包含三根K线，无法提供足够的信息来做出明智的交易决策，产生的信号可能是假的，并不能保证反转，应与其他技术分析工具和基本面分析方法结合使用。 二、黄昏星（也称黄昏之星） 黄昏星K线组合形态和启明星相反，出现在上升趋势或者反弹中，也是由三根K线组成。第一根K线是大阳线；第二根K线跳空高开，实体比较短小；第三根K线是一根大阴线。 黄昏星指标公式的代码和启明星类似，这里就不具体讲了。 如果要同时显示启明星和黄昏星，把上面两个公式合并起来就可以了，但是要修改变量名，不然重名了。最后还是要提醒一下，启明星和黄昏星K线组合形态提供的信息太少，需要结合其他分析方法使用，不建议单独使用。 ","link":"https://blog.elex.vip/post/di-er-shi-pian-tong-da-xin-zi-dong-ti-shi-qi-ming-xing-huang-hun-xing-k-xian-zu-he-xing-tai-han-zhi-biao-gong-shi-dai-ma-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第十九篇——创业板、科创板也适用的通达信涨停指标公式怎么写？（从零起步编写通达信指标公式系列） ","content":"内容提要：上一篇文章提到连板梯队的代码不完善，没有对主板和创业板、科创板涨停进行区分，主板涨停是10%，而创业板、科创板涨停是20%，区别还是比较大的。今天就来给大家介绍如何区分。 区分主板和创业板、科创板，主要有两种方法： 第一种利用股票代码进行区分，创业板的股票代码以30开头，科创板的股票代码以68开头，利用这个特征，可以和主板区分开来。 第二种利用板块进行区分，创业板、科创板为两个特定的板块。 知道了这两种方法，接下来介绍使用的函数。除了创业板、科创板，去除ST、*ST的股票也经常用到，顺便介绍一下。 一、通达信函数 1、CODELIKE函数 含义：CODELIKE由code和like两部分组成，code的意思是“代码”，like的意思是“像…一样”，组合起来就是“像…一样的代码”，通过英文的意思可以了解CODELIKE函数的大概意思。在通达信编程语言中，CODELIKE用来模糊匹配股票代码，查询股票代码是否以设定的参数开头。 我们上面说到创业板，大家应该知道创业板以30开头，CODELIKE('30')就可以查找出以30开头的股票代码，即创业板股票。科创板以68开头，CODELIKE('68')可以找出以68开头的股票代码。使用函数的时候，要注意，数字要加英文单引号，不然查找不到对应的股票代码。 2、INBLOCK函数 含义：INBLOCK由in和block两部分组成，in的意思是“在……里面”，block是“块”，组合起来可以理解为“在板块里”。在通达信编程语言中，可以用于查询判断股票是否属于某板块。 INBLOCK('创业板')、INBLOCK('科创板')就可以用来分别判断是否属于创业板、科创板。 3、NAMELIKE函数 除了区分创业板、科创板，在平时编写通达信指标公式的过程中，经常还会去除ST、*ST的股票，这时候就得用上NAMELIKE函数。 含义：NAMELIKE由name和like组成，name的意思是“名称”，组合起来就是“像…一样的名称”，NAMELIKE用来模糊匹配股票名称。 NAMELIKE('ST')可以用来查找ST股票，如果查找ST，NAMELIKE('ST')查找不到，因为NAMELIKE查询需要以设定的参数开头，写成NAMELIKE('')才能查到，所以如果要把ST、*ST股票都去除，使用NAMELIKE需要分别写。 4、NAMEINCLUDE函数 上面讲的NAMELIKE函数，去除ST、*ST，需要分别写，而NAMEINCLUDE不需要，因为NAMEINCLUDE只需要名称中包含设定的参数就可以找到。 含义：NAMEINCLUDE由name和include组成，name的意思是“名称”，include的意思是“包含”，在通达信编程语言中的意思就是查询股票名称中是否包含设定的参数。 ST、*ST股票名称的共同特征是都包含了ST，NAMEINCLUDE('ST')就可以把名称中包含ST、*ST的股票都找出来。 二、完善涨停指标公式 通过上面对一些函数的学习，就可以完善之前的涨停指标公式。 涨停（适用于除ST、*ST的沪深A股） ","link":"https://blog.elex.vip/post/di-shi-jiu-pian-chuang-ye-ban-ke-chuang-ban-ye-gua-yong-de-tong-da-xin-zhang-ting-zhi-biao-gong-shi-zen-me-xie-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第十八篇——怎么在通达信上设置连板次数以及所属行业（从零起步编写通达信指标公式系列） ","content":"内容提要：前两天有人问通达信怎么设置连板梯队，之前也没弄过，一开始觉得有点麻烦，没时间，不太想弄。后来发现自己想复杂了，问的是连板，而不是几天几板，这就简单多了。抽空弄了一下，三句代码完事。效果如下图。 一、通达信指标公式代码解析 代码如下： 简单介绍一下思路： ZT:=C/REF(C,1)&gt;1.095 AND C=H;，这一句是涨停，没啥好说的，如果不知道什么意思就去看之前写的文章《第五篇——通达信指标公式编写常用函数（一）——REF、MA、EMA、CROSS（从零起步编写通达信指标公式系列）》，文章里做过详细解释。 连板数:BARSLAST(ZT=0);，ZT是涨停，ZT=0就代表没有涨停，这一句计算上次没有涨停距离今天的周期数。举例详细说一下，如果今天没涨停，那今天距离今天就是0；如果今天涨停了，昨天没有涨停，那么上次就是昨天，距离今天就是1；如果如果今天涨停了，昨天也涨停了，前天没有涨停，那么上次就是前天，距离今天就是2。以此类推，这样BARSLAST(ZT=0)就和连板数是一致的。 BARSLAST这个函数真的很常用而且很重要，稍微有点难理解，不过一旦理解了并能熟练使用，很多疑难问题可以迎刃而解。没有理解的，可以再去学习一下这篇文章《第九篇——通达信指标公式编写常用函数（五）——BARSLAST（从零起步编写通达信指标公式系列）》。 所属板块:DRAWTEXT(ISLASTBAR,0,HYBLOCK);，这一句就是为了显示所属板块，根据要求加的，效果如上图的最后一列。HYBLOCK如果直接使用显示的是数字而不是板块的中文名称，所以加上DRAWTEXT显示文字。整句的意思是在今天的0位置书写文字，在哪个位置写文字不重要，重要的是把文字显示出来，因为这个指标不是加载到看盘界面的，而是用于排序界面。 代码介绍完了，把这段代码保存为“连板梯队”，下面要用的。接下来给大家介绍，如何设置连板梯队指标排序界面。 二、界面设置 指标排序具体位置在通达信右上角，“功能——报表分析——历史行情.指标排序”。 有的通达信版本，位置可能不同，找不到可以用通达信键盘精灵，在通达信软件界面，输入“.401”，然后按回车键，就可以调出历史行情.指标排序界面。（如下图） 在最上面的栏目，右键，出现“更改排序指标”。 选择之前保存的“连板梯队” 然后就出现了本文开头的那张图，点一下“连板数”，可以进行排序。 最后强调一点，本文的通达信指标公式并不完善，科创板、创业板的涨跌幅是20%，没有对这两个板块进行单独处理。那为什么不写呢？ 懒得写 哈哈，开个玩笑，后面有机会，单独写一篇文章来介绍如何处理科创板、创业板。这次就先这样吧。 ","link":"https://blog.elex.vip/post/di-shi-ba-pian-zen-me-zai-tong-da-xin-shang-she-zhi-lian-ban-ci-shu-yi-ji-suo-shu-xing-ye-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第十七篇——手把手教你调整通达信指标的颜色、线形粗细、线型（从零起步编写通达信指标公式系列） ","content":"内容提要：本文介绍了通达信指标公式常用绘图函数的第三种类型——修饰函数，主要讲解了颜色、线形粗细、线型这三种修饰函数的具体使用方法。 在《第三篇——通达信指标公式编写基础（一）（从零起步编写通达信指标公式系列）》这篇文章中讲过通达信指标公式语句的基本组成部分（如下图），包含了这四部分的的语句就可以正常执行了，如果语句不完整就会报错。这其实就像我们必须穿衣服一样，是一种基本的规范，而修饰函数就像戴戒指、项链，是可选的，如果选择使用它，可以使指标更醒目、更美观，方便我们观察。 修饰函数的使用方法很简单，在语句内容之后，加上英文逗号（,），然后再加上修饰函数，最后以结束符（;）结尾。 上图中例子只是加了颜色修饰，如果想修改均线的粗细怎么办呢？很简单，再加一个英文逗号和修饰函数就行了。也就是说可以一段语句可以加几个修饰函数。 举例： 这段语句，给5日均线加了三个修饰函数，分别是颜色为黄色，线宽是1，线型为虚线。（如下图） 下面给大家详细介绍颜色、线形粗细、线型这三类修饰函数。还有其他类型的修饰函数，我平时使用不多，暂时就不介绍了，可以自行查询函数库。 一、颜色 颜色函数格式是“COLOR+颜色”，比如COLORRED就是“COLOR+RED”，RED是英文“红色”。在通达信的“指标公式编辑器——插入函数——线型和资源等”，可以找到常见的颜色。 如果这些常见的颜色不能满足你的需求，可以自定义颜色。 第一种方法，用COLOR+BBGGRR这样的格式定义。这个自定义颜色采用16进制，觉得大家也不用去研究了，这样的方式自定义不方便。 第二种方法，用调色板，自己调颜色，所见即所得。“指标格式编辑器——调色板”，在弹出的窗口，点击“规定自定义颜色”，即可开始调颜色，调好之后点击“添加到自定义颜色”，并“确定”，就能在编辑器窗口得到颜色的代码。 二、线形粗细 线形粗细用LINETHICK进行调节，格式是“LINETHICK+数字”，数字的取值范围是1到9，LINETHICK1最细，LINETHICK9最粗。粗细对比可以查看下面两张图。 三、线型 线型相关的函数主要有三个，CROSSDOT小叉线、CIRCLEDOT小圆圈线、DOTLINE虚线。 CROSSDOT小叉线 CIRCLEDOT小圆圈线 DOTLINE虚线 经过五篇文章的介绍，大家应该对绘图函数有了一定的了解，希望能对大家学习编写通达信指标公式有所帮助。只看文章是不行的，一定要动手编写指标公式。 ","link":"https://blog.elex.vip/post/di-shi-qi-pian-shou-ba-shou-jiao-ni-diao-zheng-tong-da-xin-zhi-biao-de-yan-se-xian-xing-cu-xi-xian-xing-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第十六篇——学会标记函数，简单实现通达信指标公式做标记（从零起步编写通达信指标公式系列）","content":"内容提要：前面两篇文章介绍了通达信指标公式的画线函数，今天给大家介绍绘图函数的第二种类型——标记函数，讲解DRAWICON、DRAWTEXT、DRAWNUMBER的具体用法。标记函数可以给指标发出的信号做醒目的标记，方便我们查看信号。 一、DRAWICON函数 含义：绘制图标 使用方法: DRAWICON(COND,PRICE,TYPE) 当满足COND条件时，在PRICE位置画图标。 TYPE是图标的编号，编号对应的图标从“指标公式编辑器——插入资源——图标”这里查找。（如下图） 点击上图中的图标之后，会出现“设置图标”窗口，鼠标悬停在图标上，就会提示几号图标。（如下图） 举例: 5日均线、10日均线金叉时，在最低价位置画1号图标 如果觉得小箭头离K线太近，看不清楚，可以把小箭头的位置往下挪动。比如下图，L*0.97，就是把小箭头的位置往下挪动了3%，这样小箭头看得更清楚。 二、DRAWTEXT函数 含义：写文字 使用方法： DRAWTEXT(COND,PRICE,TEXT) 当满足COND条件时，在PRICE位置写文字，文字的内容TEXT由我们自行设定。 这样一看，其实和DRAWICON没什么两样，只不过画图标需要从46个图标中选择，写文字可以自己设定内容而已。 举例： 注意的是，TEXT必须要用英文单引号，用了中文引号或者没有用引号都会报错。（如下图） 三、DRAWNUMBER函数 含义：写数字 使用方法: DRAWNUMBER(COND,PRICE,NUMBER) 当满足COND条件时，在PRICE位置书写数字，数字的内容是NUMBER。这个NUMBER可以是自己设定的某个数字，也可也是变量，比如成交量VOL之类的。 举例： DATE&lt;&gt;REF(DATE,1)表示当前的日期和前一根K线的周期不同，当指标加载到5分钟图上的时候，就表示开盘后的第一根5分钟K线。整句代码的意思是在开盘第一根5分钟的最低价写上成交量的具体数字。（如下图） 总体来说，DRAWICON、DRAWTEXT、DRAWNUMBER这三个标记函数比较简单，使用方法也类似，但是非常实用。可以用这三个函数练习，对一些常见的指标进行修改，在发出信号的位置添加标记，多上手才能熟能生巧。 ","link":"https://blog.elex.vip/post/di-shi-liu-pian-xue-hui-biao-ji-han-shu-jian-dan-shi-xian-tong-da-xin-zhi-biao-gong-shi-zuo-biao-ji-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第十五篇——如何编写通达信指标公式实现自定义K线（从零起步编写通达信指标公式系列） ","content":"内容提要：在前一篇文章中已经介绍了和画线有关的四个绘图函数，今天将介绍两个函数DRAWKLINE和STICKLINE，可以实现自定义K线。DRAWKLINE功能比较单一，只能通过高开低收4个参数画K线。STICKLINE画柱线，通过参数的设定可以实现完全重画K线，包括调整宽度、线型、颜色等，真正做到自定义。 一、DRAWKLINE函数 含义：DRAWKLINE函数可以拆成三个部分理解：DRAW、K、LINE。DRAW是指 &quot;画&quot;，LINE是指 &quot;线&quot;，因此整个函数的意思就是“画K线”。 举例： DRAWKLINE(HIGH,OPEN,LOW,CLOSE); DRAWKLINE高开低收四个参数，对应好参数的位置就可以画出K线图。 把指标公式加载到副图，就可以看出和主图数据是一样的。当然因为附图被压扁的原因，看起来不一样而已。 从上面的介绍来看，感觉DRAWKLINE这个函数也没什么用，这里提供一个常见的用法。有时候我们想比较个股和大盘的相对强度，DRAWKLINE就可以帮我们实现。 DRAWKLINE(INDEXH,INDEXO,INDEXL,INDEXC); INDEXH,INDEXO,INDEXL,INDEXC是个股对应的大盘指数的高开低收价格，具体的这里先不讲，后面有机会再说。把上面的指标公式加载到副图（如下图），红色箭头处明显可以看出个股和大盘的相对强度。 DRAWKLINE只能输入高开低收四个参数，可以对价格做一些调整，相对来说使用范围比较窄，如果要真正实现自定义K线，完整实现画出K线的过程，需要用到STICKLINE函数。STICKLINE是一个非常实用，使用频率非常高的函数，有必要重点学习并熟练掌握使用方法。 二、STICKLINE函数 含义：画柱线 使用方法: STICKLINE(COND,PRICE1,PRICE2,WIDTH,EMPTY) 当满足COND条件时,在PRICE1和PRICE2位置之间画柱线； WIDTH表示柱线的宽度，如果WIDTH为4，就是标准间距)； EMPTY表示柱线是实心还是空心，如果EMPTY为0就是实心柱，为1就是实线空心柱，为-1画就是虚线空心柱。当然也可以为其他数，只不过都是实线空心柱。 举例: 可以看到，上图白线柱线就是满足创20日新高条件的，柱线宽度WIDTH为3，就和图上的K线宽度相同，能完全覆盖原来的K线实体部分，比较美观一些。但是只覆盖实体，没有覆盖影线部分，还是不够完美，那能不能做到覆盖影线呢？答案是肯定的。 其实只需要在最高价和最低价之间画宽度WIDTH为0的柱线，实际画出的就是影线。 注意一点，要把画影线代码写在画柱线前面，计算机执行代码是从上往下执行的，先画出影线，再画柱线，这样柱线是覆盖在影线之上的。否则就会出现下图这样的情况，影线在柱线之上，不太美观。 当然影线和柱线的颜色相同的时候也看不出来，颜色不同时才会出现上图的情况。至于柱线的颜色如何自定义，在接下来介绍修饰函数时再给大家讲。 利用STICKLINE函数画出K线只是其中一个应用，STICKLINE函数很多时候用在副图指标中，在副图上画出柱线。比如今天是阳线，就画出正的成交量柱（红色）；今天是阴线，就画出负的成交量柱（绿色）。 代码如下： 通达信编写指标公式常用的画线函数就讲完了，下一篇文章中会讲解标记函数，给指标信号增加一些醒目的标记。 ","link":"https://blog.elex.vip/post/di-shi-wu-pian-ru-he-bian-xie-tong-da-xin-zhi-biao-gong-shi-shi-xian-zi-ding-yi-k-xian-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第十四篇——如何用通达信绘图函数画线？（从零起步编写通达信指标公式系列） ","content":"内容提要：本文主要介绍了通达信指标公式常用绘图函数的第一种类型——画线函数，讲解了DRAWNULL、NODRAW、PLOYLINE、DRAWSL这四个画线函数的具体用法。 在上一篇文章中，给大家简单介绍了通达信指标公式绘图函数的三种类型，接下来将详细讲解这些函数的具体用法。说到绘图函数，就不得不提到DRAW。DRAW的英文意思是“画”，许多绘图函数的名称都包含了DRAW。因此，在正式学习这些函数之前，我们有必要了解一下DRAW的含义。 今天主要讲解画线函数DRAWNULL、NODRAW、PLOYLINE、DRAWSL，简单来说画线函数可以用来画各种类型的线。 首先，介绍两个比较另类的函数NODRAW和DRAWNULL，准确来说NODRAW应该属于修饰函数，DRAWNULL属于引用函数，但是这两个函数和画线有关系，所以我就把这两个函数归类在画线函数。 一、NODRAW函数 含义：不画该线，只在加载指标的窗口左上角显示数值。 举例： 这里可能有人会想到在《第三篇——通达信指标公式编写基础（一）（从零起步编写通达信指标公式系列）》中讲到过的赋值符——冒号加等号（:=），也是不会画出来，这和NODRAW有什么区别呢？可以看下面这张图，可以看出MA5如果使用冒号加等号（:=），把指标加载到主图，MA5毫无存在感，在左上角也不显示数值，如果不看指标公式的代码，就好像完全不存在。通过两张图的对比，应该能看出区别了。 二、DRAWNULL函数 含义：返回无效数，DRAWNULL由DRAW和NULL两部分组成，DRAW是“画”，NULL的英文意思是“无效的、空的”，组合起来可以简单理解为“啥也不干”。 举例: 把指标加载到主图，可以发现震荡时，断断续续的，因为震荡时均线一会向上一会向下。这样比较难看，如果想下跌的时候也画出均线，只不过均线颜色不同，把上面的MA60的:=改为:就可以了。如果要指定均线颜色，后面再讲。 看到这里，可能又有疑问：NODRAW和DRAWNULL有什么区别呢？ 把这个公式加载到主图，对比可以发现，MA5、MA10这两条均线都不显示。但是MA5有数值，而MA10因为使用了DRAWNULL，显示的是“-”，也就是无效数据，空的。 三、PLOYLINE函数 含义：画折线段 使用方法: PLOYLINE(COND,PRICE)，满足COND条件时，把PRICE画折线连起来 举例: 不知道什么意思就看下图吧，把创新高HIGH=HHV(HIGH,20);写成指标，加载到附图，这样创新高的时候都可以看出来（红色箭头处对应的都是创新高）。创了新高，就把对应K线的最高价H（红圈处）连起来。 四、DRAWSL函数 含义：画斜线 使用方法: 当满足满足COND条件时，从PRICE位置起画斜线。 SLOPE表示斜率，SLOPE为0的时候，就表示画水平线；SLOPE为10000时，画垂直线。 LEN表示长度。当画的线为水平线或者斜线时，长度为延伸的周期数；当画的线为垂直线，长度为向上的像素高度。 DIRECT表示延伸方向。当画的线为水平线或者斜线时，DIRECT为0向右画线，1向左画线，2左右都画线；当画的线为垂直线，DIRECT为0向上画线，1向下画线，2上下都画线。 举例： DRAWSL有5个参数，看代码的时候可能记不住参数的含义，可以看指标公式编辑器下方的动态翻译。 限于篇幅，今天只介绍DRAWNULL、NODRAW、PLOYLINE、DRAWSL这四个画线函数，下一期将介绍DRAWLINE、DRAWKLINE、STICKLINE。 ","link":"https://blog.elex.vip/post/di-shi-si-pian-ru-he-yong-tong-da-xin-hui-tu-han-shu-hua-xian-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第十三篇——通达信指标公式绘图函数简介——自定义指标颜色、线型等（从零起步编写通达信指标公式系列）","content":"内容提要：本文简单介绍了通达信指标公式绘图函数的三种类型——画线函数、标记函数、修饰函数。 在之前的8篇文章中，介绍了通达信指标公式编写常用的18个函数。开始讲的几个函数比较简单，到后面一些函数理解起来都比较困难，更别说使用了，大家在看文章的时候可能也是云里雾里。学习初期，不必强求自己能完全理解，能理解的先用起来，不会的先搁置，慢慢理解，不然容易打击积极型。 学习编写指标公式只看文章不行的，必须自己上手练习，熟能生巧。可以先根据我的举例，手动打出代码，做到能够正常加载指标或者选股。在平时，根据学到的函数尝试编写一些指标，实现自己的想法，实在不会的可以提问。我讲的这18个函数基本能够覆盖大部分编写场景，反复学习研究，熟练掌握这些函数可以让你在编写指标公式的时候得心应手。 上图中的函数就是前面讲过的，刚开始学习可能会感觉比较枯燥，毕竟有的函数比较抽象，即使想办法加载到看盘界面，也不容易看懂。接下来介绍的绘图函数，难度就降低很多，可以在看盘界面上显示，有利于大家掌握使用。绘图函数比较实用，在看盘界面上加上一些提醒，有利于我们分析行情。 通达信指标公式绘图函数简介 编写通达信指标公式与画图相关的函数我这里就统称为绘图函数，主要分为三类： 1、画线函数 这类函数主要就是画各种线，常用的函数包括PLOYLINE（折线段）、DRAWSL（斜线）、DRAWLINE（直线段）、DRAWLINE（K线）、STICKLINE（柱状线）、DRAWBAND（带状线）等。下面几张图是应用示例。 2、标记函数 这类函数主要用来做标记，比如在出现信号的地方画图板、写文字、写数字等。常用函数包括DRAWICON（图标）、DRAWTEXT（文字）、DRAWNUMBER（数字）等。通达信自带了很多图标，可以用DRAWICON函数来调用。（如下图） 3、修饰函数 修饰函数主要用来给指标添加颜色，线型以及线的粗细等，让信号更容易识别。常用函数主要包括了以COLOR颜色函数、STICK柱状线函数、DOT点线函数、LINETHICK（线型粗细）等。应用示例如下图。 今天通达信指标公式绘图函数就简介到这里，在接下来的文章中，我会详细介绍这些绘图函数并举例，希望大家能学以致用。 ","link":"https://blog.elex.vip/post/di-shi-san-pian-tong-da-xin-zhi-biao-gong-shi-hui-tu-han-shu-jian-jie-zi-ding-yi-zhi-biao-yan-se-xian-xing-deng-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第十二篇——通达信指标公式编写常用函数（八）——MAX、MIN、BETWEEN、ABS（从零起步编写通达信指标公式系列） ","content":"内容提要：本文介绍了通达信指标公式常用的数学函数MAX、MIN、BETWEEN、ABS，并用这些函数编写长上影线、均线粘合、平均真实波幅指标公式。 一、通达信常用数学函数简介 1、MAX函数 含义：求最大值 使用方法：MAX(A,B)，比较A和B的值的大小，获得较大值 举例：MAX(C,O)，表示比较开盘价和收盘价的大小，获取较大值。收盘价大于开盘价，获取的值就是收盘价。 2、MIN函数 含义：求最小值 使用方法：MIN(A,B)，比较A和B的值的大小，获得较小值 举例：MIN(C,O)，表示比较开盘价和收盘价的大小，获取较小值。收盘价大于开盘价，获取的值就是开盘价。 3、BETWEEN函数 含义：介于，BETWEEN的英文意思是“在…中间”，在通达信编程语言中也是这样的意思。 使用方法：BETWEEN(A,B,C)，表示A在B和C之间时满足条件，返回1，也就是说B&lt;A&lt;C或C&lt;A&lt;B，其他情况不满足在中间的条件，就返回0 举例： 表示收盘价介于5日、10日均线之间（如下图） 4、ABS函数 含义：求绝对值 使用方法：ABS(X)，获得X的绝对值，也就是说X不管是正数还是负数，用了ABS函数，最后的结果都是正数，当然X=0，最后结果也是0 举例：ABS(-10)，得到结果10 二、函数综合运用编写指标公式 长上影线 长上影线有3种情况，阴线、阳线和十字星（如上图箭头处），对应的就是C&lt;O（收盘价小于开盘价），C&gt;O（收盘价大于开盘价），C=O（收盘价等于开盘价）。虽然有这三种情况，但是我们没必要进行区分，只需要知道K线最高价到K线实体的上沿之间的波幅就可以了。（如下图） 实体的上沿就是收盘价C和开盘价O中的较大值，用MAX(C,O)即可获得实体的上沿。H-MAX(C,O)是K线最高价距离K线实体的上沿之间的波幅（上图黄色箭头区间），H-L是最高价与最低价的波幅。 A1:=(H-MAX(C,O))/(H-L)&gt;0.6;，这句的意思就是上影线占到整根K线的比例大于60% A2:=H/L&gt;1.05;，表示K线最高价最低价之间的幅度大于5%，这个是为了过滤一些比较短小的K线 2、均线粘合 公式中的5、10、20日均线就不用说了，解释一下MAXJX、MINJX。 首先来说MAXJX这一句，MAX(MA5,MA10)是获得5日均线、10均线的较大值，MAX(MAX(MA5,MA10),MA20)是用前面获得的5、10日均线的较大值与20日均线的值比较，最终获得5、10、20日这三条均线中的最大值。类似的，MINJX是获得5、10、20日这三条均线中的最小值。以下图箭头处的均线为例，就是比较三个圆圈处的均线值，获得最大值、最小值。 BL获得最大值、最小值之间的幅度。 XG:EVERY(BL&lt;1,5);，最后一句限制最大值、最小值之间的幅度小于1%，并且要最近5个天一直满足这个条件。如果不熟悉EVERY的用法，可以看《第八篇——通达信指标公式编写常用函数（四）——EVERY、COUNT（从零起步编写通达信指标公式系列）》。 3、平均真实波幅指标(ATR) 获得平均真实波幅之前需要先获得真实波幅，真实波幅是以下abc三者的最大值。 a、今天的最高价与最低价的波幅(H-L)； b、前一天收盘价与今天最高价的波幅ABS(REF(C,1)-H)； c、前一天收盘价与今天最低价的波幅ABS(REF(C,1)-L)。 今天K线可能向上可能向下，但是我们想获得的波幅是正的，所以用ABS求绝对值。 求三者的最大值，上面已经讲过了，用两个MAX就可以。前面两个比较一下，再与第三个比，获得最大值。 获得MTR之后用MA函数，求一下简单移动平均，就得到ATR。 ","link":"https://blog.elex.vip/post/di-shi-er-pian-tong-da-xin-zhi-biao-gong-shi-bian-xie-chang-yong-han-shu-ba-maxminbetweenabscong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第十一篇——通达信指标公式编写常用函数（七）——SUMBARS以及MACD底背离（从零起步编写通达信指标公式系列）","content":"内容提要：本文主要介绍通达信指标公式常用函数SUMBARS以及函数的应用，并且综合运用函数来编写MACD底背离。 一、SUMBARS函数简介 SUMBARS这个函数名由SUM和BARS两部分组成，SUM在前一篇文章《第十篇——通达信指标公式编写常用函数（六）——SUM、IF（从零起步编写通达信指标公式系列）》中已经讲过，是统计总和的意思，BARS是我们的老朋友了，之前讲的HHVBARS、BARSLAST都是用来统计周期数，SUMBARS也不例外。 SUMBARS函数 含义：向前累加到指定值到现在的周期数 使用方法：SUMBARS(X,A)，将X向前累加直到大于等于A，获得这个区间的周期数 二、SUMBARS函数应用举例 SUMBARS(X,A)，当A=1的时候可以实现BARSLAST的功能，但是SUMBARS比BARSLAST的应用更广泛。 以MA5、MA10金叉为例，获得上一次金叉到现在的周期数 加载到副图，可以发现A1、A2重叠，也就是说上面两种方法获得的结果是一样的。 BARSLAST只能获取上一次条件成立到当前的周期数，但是如果要获取上上次条件成立到现在的周期数，BARSLAST就无能为力了。这时候SUMBARS就派上用场了。SUMBARS(X,A)，A=2就能解决这个问题。 还是以5日、10日均线金叉为例，获取累计到两次金叉这个区间的周期数 文字理解有困难，直接看下图，1和12是金叉的位置，SUMBARS把这两根K线也算进去了，这样得到的这个区间的周期数是12。下图箭头处对应的白线A1的值就是12。 三、函数综合运用 MACD底背离 价格创新低，MACD指标的DIF不再创新低。 在出现MACD底背离之后，在DIF、DEA金叉的时候选出来。（效果如上图黄色箭头处） 说实话比较难，即使不是自己写，理解公式代码都有难度。 先上代码： 代码解释： a、 这两句就不用多做解释，分别获得DIF（快线）、DEA（慢线） b、 JC表示零轴之下DIF、DEA金叉，JT表示获得零轴之下金叉两次这个区间的周期数 c、 SC表示DIF、DEA死叉，ST表示上一次死叉到当前的周期数 d、 这两句有难度，先看下图吧。当前（最右边）这根K线对应的DIF、DEA是金叉。 区间1：从上次DIF、DEA死叉到当前金叉这个区间； 区间2：从上上次DIF、DEA死叉到上次金叉这个区间。 D1是图中区间1的DIF最低值； D2是图中区间2的DIF最低值。 接下来解释一下语句的具体逻辑，比较难理解，也觉得有点难为大家了，估计直接把大家劝退了，下面这段能看懂就看吧，看不懂就算了。 DT表示上一次死叉以来，DIF的最低值到当前的周期数； D1表示获取上次死叉以来DIF的最低值（上图D1）； D2表示返回到上次金叉那里（上图从左往右第二根黄色竖线处），获取对应的D1值，实际上就是区间2的最低值（上图D2）。因为语句有了嵌套，理解起来就难了。 e、 这两句和上面两句类似，只不过变成了获取区间内K线最低价的最低值。 L1是图上区间1的K线最低价的最低值； L2是图上区间2的K线最低价的最低值。 代码逻辑就不详细解释了，和上面的解释类似。 f、 当前金叉，并且区间价格低点创新低，并且区间DIF低点抬高，符合条件的选出来。 四、答疑 问： 20日内有涨幅大于5%的，并且该日收盘价小于当前日收盘价，还并且该日收盘价大于该日前10日内收盘价的最高值。 说明：可能20日内还有涨幅大于5%的，只要有1日符合上述要求就行。 代码： 感觉结果不是太理想，选出来的结果太多了。 ","link":"https://blog.elex.vip/post/di-shi-yi-pian-tong-da-xin-zhi-biao-gong-shi-bian-xie-chang-yong-han-shu-qi-sumbars-yi-ji-macd-di-bei-chi-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第十篇——通达信指标公式编写常用函数（六）——SUM、IF（从零起步编写通达信指标公式系列）","content":"内容提要：本文主要介绍了编写通达信指标公式常用函数SUM、IF，并结合自带OBV指标熟悉函数的使用。 在《第五篇——通达信指标公式编写常用函数（一）——REF、MA、EMA、CROSS（从零起步编写通达信指标公式系列）》这篇文章中讲到均线相关的函数MA，这里简单复习一下。 MA(C,N)：收盘价的N日简单移动平均 计算方法：MA(C,N)=(C1+C2+C3+...+Cn)/N 之所以称之为简单移动平均线，就是简单加起来再除，而不像EMA之类的均线，涉及到加权。以60日简单移动平均线MA60举例，就是最近60个交易日的收盘价加起来求和，然后除以60。今天讲的SUM函数就是用来求和。 一、SUM函数 含义：SUM的英文意思就是“总和”，在通达信编程语言中也是这样的意思。 使用方法：SUM(X,N)，统计N周期中X的总和。有一种特殊的用法，N=0的时候表示统计从上市第一天以来的X的总和 举例： 大家都知道60日均线的写法，就是MA(C,60)，用SUM函数来写，可以实现同样的效果。 SUM(C,60)，求得60个交易日的收盘价之和，然后除以60，SUM(C,60)/60;，就得到60日均线。可以把这两种写法对比一下。 叠加主图之后发现，只显示一条均线，其实是两条均线重合了。下图左上角的箭头处，可以发现两条均线的值是相同的。 二、IF函数 IF函数是一个常用而且非常重要的函数，用来进行条件判断。在第一篇文章《第一篇——为什么要学编写通达信指标公式（从零起步编写通达信指标公式系列）》中就举过均线拐头变色的例子，就是使用IF函数来判断。 含义：IF的英文意思是“如果”，在通达信编程语言中，也是这样的意思。 使用方法：IF(X,A,B)，如果X条件成立，得到的结果就是A；如果X条件不成立，得到的结果就是B。IF函数和之前讲的函数有一个明显的区别，就是有三个参数X、A、B，之前讲的函数一般是两个。 举例： 三、函数综合运用 今天结合交易软件自带的能量潮指标（OBV），来熟悉SUM函数和IF函数的使用。通过对指标代码的解读，可以对指标的使用方法有更深的认识。 OBV指标： a、VA:=IF(C&gt;REF(C,1),V,-V); C&gt;REF(C,1)表示今天的收盘价大于昨天的收盘价，也就是说今天是上涨的。整句的意思：如果今天是上涨的（C&gt;REF(C,1)），VA的结果就是V（正的成交量）；如果今天是下跌的（C&lt;REF(C,1)）或者今天不涨不跌（C=REF(C,1)），VA的结果就是-V（负的成交量）。 b、VA1:=IF(C=REF(C,1),0,VA); C=REF(C,1)表示今天收盘价等于昨天收盘价，也就是今天不涨不跌。整句的意思：如果今天不涨不跌，VA1的结果就是0，否则就是VA。 这是什么意思呢？上面已经讲过有三种情况，今天上涨、今天下跌、今天不涨不跌。在上一句公式中，今天不涨不跌（C=REF(C,1)），得到的结果是-V，而这一句重新赋值了，变成了今天不涨不跌，结果就是0。 这样今天上涨、今天下跌、今天不涨不跌，这三种情况就得到三个结果，分别是今天上涨V、今天下跌-V、今天不涨不跌0。 c、OBV:SUM(VA1,0); 表示统计从上市第一天以来的VA1的总和，简单说一下就是上涨了加上一个V，下跌了减去一个V，不涨不跌加上一个0，这样累加起来。 d、MAOBV:MA(OBV,30); 这句表示30日的OBV值简单移动平均 四、答疑 问：能写出来了吗，两个涨停中间，有几日收盘价大于第一个涨停收盘价的具体数字，比如3日，5日或其他数字公式？ 代码： ","link":"https://blog.elex.vip/post/di-shi-pian-tong-da-xin-zhi-biao-gong-shi-bian-xie-chang-yong-han-shu-liu-sumifcong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第九篇——通达信指标公式编写常用函数（五）——BARSLAST（从零起步编写通达信指标公式系列） ","content":"内容提要：本文主要介绍了编写通达信指标公式常用函数BARSLAST以及综合运用最近讲过的函数编写MACD零轴之上首次金叉选股公式。 一、BARSLAST函数简介 含义：上一次条件成立到当前的周期数 使用方法：BARSLAST(X)，上一次X条件成立到当前的周期数 举例：BARSLAST(CROSS(MA(C,20),MA(C,60)));，表示上一次20日均线60日均线金叉到当前的周期数 之前讲过的HHVBARS、LLVBARS以及今天讲的BARSLAST函数，都是用来获取周期数。 这种类型的函数有两种常见的应用场景： 根据获得的周期数，用REF函数返回去引用数据，比如上面的例子，获得了上一次20、60日金叉到现在的周期数，然后用REF往前引用，获取金叉那根K线对应的收盘价。 根据获取的周期数确定了一个区间，在这个区间里找满足条件的。在之前的文章《第七篇——通达信指标公式编写常用函数（三）——HHVBARS、LLVBARS（从零起步编写通达信指标公式系列）》已经举过HHVBARS的例子，下面再举一个BARSLAST的例子，增加大家对函数应用场景的理解。 二、函数综合运用 在平时看盘的过程中，应该能发现这样的情况，很多上涨行情并不是直挺挺地拉升一波就结束了，而是在上涨过程中也有回调，呈现波浪式上涨。我们希望能选出调整结束之后再次拉升的股票，并且在再次拉升初期发现这只股票。比如下图。 在这个过程中，MACD指标也会有相应的变化（上图中副图为MACD指标）。随着行情的上涨，MACD指标的DIF（快线）、DEA（慢线）逐渐爬升到零轴上方，然后行情回调，DIF、DEA死叉并且开始向零轴附近回调。当行情再次拉升，DIF、DEA在零轴之上金叉，这时候可能就是好的机会。（当然我这里的设想都是比较理想化的情形，实际行情中会出现各种情况，并不如设想这么美好。） 基于以上设想，我们想找出DIF、DEA爬升到零轴之上以后，出现的第一次金叉。这样就涉及到以下几个条件： a、MACD指标的DIF、DEA b、DIF、DEA上穿零轴以来（慢线DEA比快线DIF稳定，写公式就用DEA来写）。 CROSS(DEA,0)表示DEA上穿零轴，然后用BARSLAST取得DEA上穿零轴到现在的周期数。 c、DIF、DEA零轴之上第一次金叉 因为我们想选出今天DIF、DEA金叉的股票，所以今天要满足CROSS(DIF,DEA)，另外还要保证是DEA上穿零轴以来的第一次金叉，所以用上一篇文章中讲到的COUNT函数，统计DEA上穿零轴以来的金叉次数等于1次。这个条件就涉及到我上面讲到的获取周期数函数的第二种用法，先获取到周期数，确定一个区间，在这个区间里找满足条件的。另外要加入限制条件DEA&gt;0，才符合零轴之上金叉，不然有的股票不满足，也会被选出来。 最后上公式 MACD零轴之上首次金叉（保存成条件选股公式就可以选股，保存成技术指标公式可以加载到副图） ","link":"https://blog.elex.vip/post/di-jiu-pian-tong-da-xin-zhi-biao-gong-shi-bian-xie-chang-yong-han-shu-wu-barslastcong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第八篇——通达信指标公式编写常用函数（四）——EVERY、COUNT（从零起步编写通达信指标公式系列）","content":"内容提要：本文主要介绍了编写通达信指标公式会用到的EVERY函数、COUNT函数以及函数的应用举例。 一、函数简介 1、EVERY函数 含义：EVERY英文翻译成中文是“每个”的意思，在通达信编程语言中，EVERY函数的含义是“一直存在”。 使用用法：EVERY(X,N) ，表示N周期内一直存在X条件，X条件比较常见的情况是关系运算，比如A&gt;B之类的。 举例：EVERY(C&gt;O,3);，以日线为例，表示三连阳 再举一个稍微复杂一点的例子，EVERY(C&gt;REF(C,1),3);，以日线为例，表示连涨3天。新手看到结构比较复杂的语句，可能会看不明白，可以先找到逗号(,)，然后按照X、N的前后位置，按序区分。详解如下图。 其实在自己编写通达信指标公式的过程中，可以把一句代码写成两句，这样更清晰明了。 另外看指标公式编辑器下方的动态翻译，可以帮助了解公式语句的含义。（下图方框箭头处） 2、COUNT函数 含义：COUNT英文翻译成中文就是“计数”的意思，在通达信编程语言中，COUNT函数的含义是“统计满足条件的周期数”。 使用方法：COUNT(X,N)，统计N个周期中满足X条件的周期数 举例：COUNT(C&gt;O,10);，以日线为例，表示统计10天中阳线的数量。 COUNT函数比EVERY函数更灵活，比如上面的例子EVERY(C&gt;O,3);三连阳，可以用COUNT函数写出来，COUNT(C&gt;O,3)=3;表示3天中有3天是阳线，也就是三连阳。 二、函数应用举例 1、60日均线持续向上 代码如下： 代码详解： a、MA60:=MA(C,60);，表示60日均线； b、A1:=MA60&gt;REF(MA60,1);，表示今天60日均线的值大于昨天的，也就是说60日均线向上； c、JXCXXS:EVERY(A1,10);，表示10天一直满足A1条件，也就是说10天一直满足60日均线向上 2、强势上涨 代码如下： 代码详解： a、A1:=(HHV(H,10)-LLV(L,10))/LLV(L,10)&gt;0.1;，表示10日内低点到高点的幅度大于10%； b、A2:=COUNT(C&gt;O,10)&gt;8;，10天中有8天实阳线，这就是强势的特征； c、A3:=EVERY(MA(C,60)&gt;REF(MA(C,60),1),10);，这一句眼熟吗？就是上面的例子“60日均线持续向上”，我把几句代码合成一句了，这一句用来过滤掉K线在60均线下方反弹的情况； d、QS:A1 AND A2 AND A3;，把A1、A2、A3三个条件用AND连起来，三个条件要同时成立。 今天介绍了EVERY函数、COUNT函数这两个函数，下一篇文章会介绍BARSLAST函数，并结合这几个函数编写一个比较实用的指标——MACD零轴之上首次金叉。 ","link":"https://blog.elex.vip/post/di-ba-pian-tong-da-xin-zhi-biao-gong-shi-bian-xie-chang-yong-han-shu-si-everycountcong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第七篇——通达信指标公式编写常用函数（三）——HHVBARS、LLVBARS（从零起步编写通达信指标公式系列） ","content":"内容提要：本文主要介绍了HHVBARS函数、LLVBARS函数、函数的应用举例以及函数的综合运用。 HHVBARS这个函数名由HHV和BARS两部分组成，HHV是最高值，BARS是英文，翻译成中文就是K线的意思。从这个函数名就能看出来，HHVBARS函数和最高值对应的K线有关系。LLVBARS类似，在下面的文章中，主要以HHVBARS为主进行讲解。 在前一篇文章《第六篇——通达信指标公式编写常用函数（二）——HHV、LLV（从零起步编写通达信指标公式系列）》中讲过HHV(X,N)，表示N个周期内X的最高值，但是从获得的结果并不能确定最高值对应的那根K线，而通过今天讲的HHVBARS，获得上一最高值到当前的周期数，就可以确定最高值对应的K线。 可能还有点迷糊，举一个更通俗的例子，比如60个人随机排队，HHV函数可以获得这60个人的最高身高是190cm，但是却不知道身高最高的人是谁。是小张、小王还是小李？通过HHVBARS函数可以获得身高最高的那个人的相对位置，就能确定是谁了。 一、HHVBARS、LLVBARS函数简介 1、HHVBARS 含义：获得上一最高值到当前的周期数 使用用法：HHVBARS(X,N)，获得N个周期内X最高值到当前的周期数 举例：HHVBARS(H,60)，以日线为例，就是获得60日内最高点到当前的周期数 （在上一篇文章中，有粉丝提出最高价、最高值的区别，这里就用“最高点”来代替“最高价的最高值”这种比较拗口的说法。） 2、LLVBARS 含义：获得上一最低值到当前的周期数 使用用法：LLVBARS(X,N)，获得N个周期内X最低值到当前的周期数 举例：LLVBARS(L,60)，以日线为例，就是获得60日内最低点到当前的周期数 二、HHVBARS函数应用举例 函数可能比较抽象，不容易想明白，这时候就可以用笨方法，把语句代码保存成指标，加载到副图上看一下。 上图中，最下方的白线就是HHVBARS(H,60)。以红色箭头处的最高点为例，红色圆圈那里的HHVBARS(H,60)获得的就是最新一根K线到最高点那根K线的周期数（图上黄色区间）。 三、通达信指标公式函数综合运用举例 低位区域指标 总体思路：从60日高点开始，下跌超过30% 先上代码： 代码详解： **a、**HH:=HHV(H,60);，这一句获得60日高点的值； **b、**HB:=HHVBARS(H,60);，获得60日高点距离当前的周期数（可以参考上面应用举例里的黄色区间）； **c、**LL:=LLV(L,HB+1);，获得60日最高点到当前这个区间的最低点（可以参考上面应用举例里黄色区间的最低点）； **d、**DWQY:(HH-LL)/HH&gt;0.3;，下跌超过30%，返回结果为1，否则为0。 提醒一下，这个指标公式只是为了举例，并不建议大家抄底，逆势操作风险还是比较大的。 这两天开始讲函数，内容比较干，各位粉丝朋友阅读起来可能有一定的困难，但是作为通达信编写指标公式学习框架的重要组成部分，又不得不讲解。各位粉丝朋友只能先干货硬吃吧，后面会结合一些常见指标、交易方法进行进一步讲解，给大家理清思路。 ","link":"https://blog.elex.vip/post/di-qi-pian-tong-da-xin-zhi-biao-gong-shi-bian-xie-chang-yong-han-shu-san-hhvbarsllvbarscong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第六篇——通达信指标公式编写常用函数（二）——HHV、LLV（从零起步编写通达信指标公式系列）","content":"内容提要：本文主要介绍了编写通达信指标公式需要用到的HHV函数、LLV函数以及函数的应用举例，并结合前面讲过的函数进行综合运用。 一、HHV、LLV函数简介 1、HHV函数 含义：求最高值 使用方法：HHV(X,N)，表示N个周期内X的最高值 举例：HH:HHV(H,60);表示60个周期内最高价的最高值，有点拗口，以日线为例简单来说，就是60日最高价。 2、LLV函数 含义：求最低值 使用方法：LLV(X,N)，表示N个周期内X的最低值 举例：LL:LLV(L,60);表示60个周期内最低价的最低值，以日线为例，就是60日最低价。 通达信软件自带的KDJ指标就用到了HHV函数、LLV函数。 二、HHV函数应用举例 HHV函数有个常用的用法就是创新高（创新低就用LLV函数，写法类似），以N=60为例，公式代码如下： 创新高，按照正常理解，应该是新的高点大于60日内的高点，但是这里为什么是等于呢？ 遇到这种问题时，如果不能理解，有个简单的笨方法，就是把公式写出来，加载到主图上，看看到底是什么样子的。 以日线为例，以上公式就代表60日的最高价的最高值（60日最高价）。把指标加载到K线图上，输出的HH（60日最高价）就是下图中的白线。 上图红色箭头处，大阳线创了新高。这根大阳线的最高价是H，此时白线HH也发生了变动，仔细看一下，可以发现H是等于HH的。其实也很好理解，这根大阳线创了60日新高，此时这根大阳线的最高价就是60日内最高价的最高值（60日最高价），这就是公式中写等于的原因。 三、通达信指标公式函数综合运用举例 横盘放量突破 思路：横盘放量突破包含3个基本条件，横盘、放量、突破 a、横盘：经常看盘可以发现，如何行情横盘震荡，不同周期的均线会缠绕粘合。写横盘公式的时候就利用这个特征。首先我们要限制区间幅度，毕竟震荡区间的顶部和底部不会很宽，不然也没有意义。我这里就把60日内的最高价和最低价的区间幅度设置为30%，代码可以写成A1:=(HHV(H,60)-LLV(L,60))/LLV(L,60)&lt;0.3;，但是这样会遇到一个问题，有些V型反转的行情也会满足这个条件，但是V型反转却不符合横盘震荡。所以我们引入MA60均线，以MA60均线为基准，如果最高价和最低价能分布在MA60均线的两侧一定范围内，就可以尽可能找到横盘震荡这样的形态。以下代码A1表示60日之内的最高价与MA60均线的幅度，A2表示MA60均线与60日之内的最低价的幅度。后面可以对这个幅度进行限制。 b、放量：在前一篇文章《第五篇——通达信指标公式编写常用函数（一）——REF、MA、EMA、CROSS（从零起步编写通达信指标公式系列）》中已经提及，但是这里做一点改变，如果只是大于前一个交易日的交易量，有时候并不是那么精确，因为一天的成交量随机性比较大，有时候成交量可能很小，所以用5日均量MA(V,5)。 c、突破：我这里就定义为突破60日的最高价，60日最高价就是前面代码中的HH。 组合起来，代码如下： 加载到副图，如下图所示。加载到副图，只是为了方便展示。以上代码其实可以直接保存成选股指标，用来选股。 另外，为什么公式的最后一句A1、A2两个条件用了REF函数。我们想找出今天横盘放量突破的股票，肯定是想今天放量并且突破创了60日新高，所以A3、A4是今天要满足的。比如下图红色箭头处的K线，满足放量突破（A3、A4），但是不一定能满足横盘条件（A1、A2），如果公式中设定今天满足横盘条件（A1、A2），就可能选不出我们想要的形态。因此用REF，前一个交易日满足横盘条件就可以了。 最后说一句，选出的股票虽然不能全部满足自己的要求，但是这样大大减少了工作量，可以从选出的股票中做进一步的筛选，也可以根据上面的代码，加入更严格的限制条件，选出更符合自己要求的股票。 ","link":"https://blog.elex.vip/post/di-liu-pian-tong-da-xin-zhi-biao-gong-shi-bian-xie-chang-yong-han-shu-er-hhvllvcong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第五篇——通达信指标公式编写常用函数（一）——REF、MA、EMA、CROSS（从零起步编写通达信指标公式系列） ","content":"内容提要：本文主要介绍了编写通达信指标公式常用的函数REF、MA、EMA、CROSS以及这些函数的综合运用举例。 通达信的函数非常多，想全部熟练掌握，几乎是不可能的，而且没有必要，毕竟很多函数很少用到。 编写通达信指标公式常用的函数大概也就三四十个，对于这些函数，建议认真学习研究，多模仿练习，做到烂熟于心。打好基础很重要，如果没有打好基础，编写复杂一点的指标时，头脑可能一片空白。初期要知道函数的用法，并能在函数库中找到相应的函数。随着熟练程度逐渐提高，在编写指标时要做到直接手打函数。 对于不常用的函数，要学会使用函数库的查找功能，并借助搜索引擎，学习函数的使用方法。常用的函数方法掌握了，学习新的函数也不难。 一、通达信指标公式常用函数介绍 在前文《第四篇——通达信指标公式编写基础（二）（从零起步编写通达信指标公式系列）》中，已经介绍了基础的行情函数LOW、HIGH、OPEN、CLOSE、VOL、AMOUNT，这几个函数比较简单，就不需要再介绍了。引用函数REF有必要再讲讲。 1、REF函数 含义：引用几个周期之前的数据 使用方法：REF(X,N)，引用N个周期前的X值。 举例：涨停 REF(C,1)，表示引用前一个交易日的收盘价； C/REF(C,1)&gt;1.095，表示今天的收盘价除以前一个交易日的收盘价大于1.095，也就是说今天的涨幅大于9.5%； C=H，代表今天的收盘价和最高价相等，也就是说今天以最高价完成收盘； AND是并且的意思，也就是AND的前后两个条件要同时成立，连起来的意思是今天涨幅大于9.5%并且以最高价收盘。 这时候可能会有疑问，创业板、科创板涨跌幅限制是20%，这个公式就不适用了。确实如此，这里只是为了新手容易理解，把涨跌幅限制为10%。后面掌握了基础的函数，可以用INBLOCK函数做进一步优化。 2、MA函数 含义：简单移动平均 使用方法：MA(X,N)，X的N日简单移动平均。 举例：MA5:MA(C,5)，就是常见的5日均线，几乎所有的交易软件都会自带的。算法很简单，把最近的5个交易日的收盘价加起来，然后除以5，就得到了结果。至于为什么加载到K线图上会形成线，那是因为每根K线都会算一下，得到了结果，然后连起来，就成了均线。 3、EMA函数 含义：指数移动平均 这里的指数和上证指数中的指数并不是同一个意思，而是以指数式递减加权。 使用方法：EMA(X,N):X的N日指数移动平均。 举例：EMA12:EMA(C,12)，为什么举12日EMA均线的例子，其实是因为MACD指标按照默认参数就是使用了EMA12、EMA26这两条EMA均线。EMA指数移动平均具体的算法就不说了，对于新手来说，看到复杂的计算公式，估计会晕倒。EMA的优势是提高了近期行情的权重，对行情反应更快，优化了MA简单移动平均反应慢的问题，能够更好的反映近期的行情走势。 4、CROSS函数 含义：两条线交叉 使用用法：CROSS(A,B)，表示当A从下方向上穿过B时返回1，否则返回0 举例：5日均线、10日均线金叉，5日均线、10日均线死叉 MA5、MA10就不用介绍了，上面刚讲过 JC:CROSS(MA5,MA10);表示5日均线从下方向上穿过10日均线，也就是我们常说的金叉，金叉了返回的结果就是1，否则就是0 死叉把MA5,MA10的前后位置换一下就行了，SC:CROSS(MA10,MA5);就代表死叉。 二、函数综合运用举例 例1：放量大涨 思路：放量大涨包含了2个基本条件，一个是放量，一个是大涨。 放量我定义为今天的成交量大于前一个交易日的成交量的两倍，如果你觉得两倍不够，可以三倍或者四倍，写指标是为你的交易思路服务的，可以自行定义。代码是V/REF(V,1)&gt;2，代表今天的成交量除以前一个交易日的成交量大于2倍。这里的V是VOL（成交量）的缩写，写成V或者VOL都可以； 大涨我定义为今天涨幅大于6%，代码是C/REF(C,1)&gt;1.06，表示今天的收盘价除以前一个交易日的收盘价大于1.06，也就是涨幅大于6%； ab两个条件用AND（并且）连起来就是放量大涨。 代码如下： 加载到副图，效果如下图，最下方的三角锥就表示满足了我定义的放量大涨条件。（满足的时候值为1，不满足值为0） 例2：MACD零轴之上金叉 思路：MACD零轴之上金叉包含了3个条件，MACD、零轴之上、金叉。 MACD金叉，其实并不是MACD的值与什么金叉，而是指的MACD指标中的快线（DIF）与慢线（DEA）金叉，所以要实现MACD金叉，需要把DIF和DEA写出来。这里就用MACD指标的默认参数12、26、9。 零轴之上，就限定DIF&gt;0，DEA&gt;0 金叉，就用到上面介绍的CROSS，CROSS(DIF,DEA)就是金叉 代码如下： 把指标加载到副图，效果如下图，三角锥就表示满足了快线慢线零轴之上金叉。（满足的时候值为1，不满足值为0） ","link":"https://blog.elex.vip/post/di-wu-pian-tong-da-xin-zhi-biao-gong-shi-bian-xie-chang-yong-han-shu-yi-refmaemacrosscong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第四篇——通达信指标公式编写基础（二）（从零起步编写通达信指标公式系列） ","content":"内容提要：本文主要介绍了通达信函数、函数的分类、函数的使用方法、数据的引用以及指标修饰函数。 一、通达信函数简介 在《第一篇——为什么要学编写通达信指标公式（从零起步编写通达信指标公式系列）》这篇文章中，已经介绍过通达信函数的特性，通达信的函数就像装配式建筑中的模块。 虽然不需要知道这个模块具体怎么造出来的，但是需要知道两点： 输入：造模块需要加什么料，是加入砖、水泥还是钢筋，以及加料的先后顺序。 输出：需要知道哪个是墙板，哪个是阳台，哪个是楼梯，知道这些模块的功能，会组装模块。 函数由函数名和参数构成，参数用括号括起来，参数的先后顺序不能写错。比如简单移动平均线MA(X,N);，MA就是函数名，X和N是参数。X可以设置为CLOSE、OPEN、HIGH、LOW等。N可以设置为5、10、20等具体的数值（常量），也可以在指标公式编辑器上设置为随时可以修改的参数。通过函数运算得到的结果输出，后续可以根据自己的需求使用。（如下图） 二、函数的分类 通达信函数主要分为行情函数、财务函数、计算函数、交易函数、其他函数五大类。 三、如何使用函数 打开通达信的“指标公式编辑器”，点击“插入函数”，就可以查看通达信的函数库，了解函数的具体使用方法。如果找不到函数，也可以通过“查找(F3)”功能搜索。 双击函数之后，就会插入到指标编辑窗口。 四、数据的引用 1、基础数据引用 获得该周期最低价：LOW（或者简写成L） 获得该周期最高价：HIGH（或者简写成H） 获得该周期开盘价：OPEN（或者简写成O） 获得该周期收盘价：CLOSE（或者简写成C） 获得该周期成交量：VOL（或者简写成V） 获得该周期成交额：AMOUNT（或者简写成AMO） 2、历史数据引用 引用N日前的X数据：REF(X,N); 举例： 获得5天前的收盘：REF(CLOSE,5); 获得5天前的成交量：REF(VOL,5); 3、指标数据引用 编写公式的时候可以引用指标的输出值，基本写法：指标名.变量名，比如MACD.DIF。 五、操作符 操作符主要有三类：算数操作符、比较操作符、逻辑操作符，编写指标公式的时候经常用到。 另外注释符号花括号{}也常用。编写通达信指标公式时，有时候想在语句后面做备注，方便以后看懂语句的含义，可以使用注释符号。花括号{}之间的内容就注释掉了，不会影响公式。 六、指标修饰 可以对指标的线型、粗细、颜色进行修饰。详细的函数可以查看“线型和资源等”。 通过两篇文章的介绍，应该可以掌握通达信编写指标公式基础的内容，为后面编写公式打下基础。 ","link":"https://blog.elex.vip/post/di-si-pian-tong-da-xin-zhi-biao-gong-shi-bian-xie-ji-chu-er-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第三篇——通达信指标公式编写基础（一）（从零起步编写通达信指标公式系列）","content":"内容提要：本文主要介绍了通达信指标公式的语句构成以及指标如何设置参数。 一、什么是通达信指标公式？ 公式就是编写的代码集合，至少包含一条语句，复杂一点的公式包含多条语句。 一条语句在一般情况下主要包含四个部分，变量名、赋值符、语句内容、结束符。（为了方便理解，这四个部分的名称由我自行定义） 以5日均线为例，MA5:MA(C,5); 语句的四个部分如下图所示。 1、变量名 变量名不能以数字开头,也不能与函数名重复。 2、赋值符 赋值符一般有两种形式,冒号(😃、冒号加等号(:=)。 冒号：赋值，并且输出。输出的意思简单来说就是在看盘界面画出来，并且变量名和变量值会显示在窗口的左上角。此外也支持在指标代码中引用。 冒号加等号：赋值，不输出。也就是不会在看盘界面上显示出来，但可以在指标代码中引用。 以5日均线和10日均线举例，看一下具体的区别。 均线公式1: 公式1中，5日均线和10日均线的赋值符都是冒号（:），所以把指标加载到K线图上显示5日、10日两条均线，如下图所示。 均线公式2: 公式2中，5日均线赋值符是冒号，10日均线的赋值符是冒号加等号（:=），所以指标加载到K线图上只显示只5日这一条均线，如下图所示。 3、语句内容 语句内容就是这个变量的计算公式，计算完成后将得到的结果赋给前面的变量名。 语句内容算是一条语句的核心，有的时候如果只需要写一条语句，前面的变量名和赋值符甚至可以不需要写。但是为了方便使用指标公式，建议还是全写吧，不要偷懒了。 4、结束符 一条语句以分号(;)结尾，如果没有分号，会报错。 注意：分号(;)是英文输入法下的分号，如果是输入法是中文，输入了中文分号，也是会报错的。此外公式中的冒号、逗号、括号，都是需要在英文输入法的状态下输入，如果不慎使用了中文符号，可以根据报错的语句进行排查。报错的情况如下图。根据我平时编写指标的经验，如果变量名是中文，这种错误还是比较常见的。 二、通达信指标公式设置参数 参数：在通达信指标公式编辑器的代码编辑窗口上方，可以设置公式的参数。参数可以设置一个范围，方便后续调整。 如下图所示，MAJX:MA(C,N);就是一条MA均线，只是把原来指定的几日均线的数值换成了字母N，这个N就是参数。参数设置了最小值是1，最大值是100，缺省（也就是默认值）是5。意思很简单，就是N的取值范围是1到1000，默认是5，默认情况下这条均线是5日均线，最小可以改成1日均线，最大可以改成1000日均线。 调整指标参数：在看盘界面上加载指标之后，可以点击左上角的下拉按钮，选择“调整指标参数”。 另外也可以左键点击指标，选中了指标之后，点击鼠标右键，选择调整指标参数。 然后在弹出的窗口，把数字5改成想要的参数数值，改好之后点击关闭。如果想应用到所有周期，就点“应用到所有周期”。如果之后想恢复成在指标公式编辑器中设置的缺省值，可以点“恢复成缺省”。 这样通达信指标公式编写基础（一）就介绍完了，下一篇文章会介绍函数、数据等内容。指标公式编辑器上的其他内容这里不重复介绍，可以去看之前的文章 ","link":"https://blog.elex.vip/post/di-san-pian-tong-da-xin-zhi-biao-gong-shi-bian-xie-ji-chu-yi-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第二篇——通达信怎么编写指标公式以及通达信公式的使用方法（从零起步编写通达信指标公式系列）","content":"内容提要：本文主要介绍了通达信指标公式编写入口、公式的类型、公式编辑器的使用，此外介绍了四种公式类型的区别以及使用方法，让大家对通达信指标公式如何编写有个大概的了解。 一、公式管理器 公式管理器是编写、导入导出公式的入口。一般在通达信的右上方可以找到。“公式——公式管理器”，有的版本可能位置不在这个地方，可以找一找。 公式主要包含四种类型：技术指标公式、条件选股公式、专家系统公式、五彩K线公式 这四类公式差不多，基础编写规则学会了，编写都不成问题。 上方可以选择，有时候不知道公式保存到哪里了，可以点一下“用户”，十字点开就可以看到。 可以把编写的指标导出为文件保存或者分享给别人。 下载了现成的指标，可以直接导入，支持扩展名为tn6、tne、tni格式的文件。 先根据自己的需求选择大类，比如想编写看盘指标就点开“技术指标公式”前面的十字，想选股就点开“选股指标公式”前面的十字，然后选择一个类型，点“新建”，进入公式编辑窗口。 公式名称：可以是英文字母、中文，或者和数字混合使用，但是不能全部为数字。 公式描述：简单描述一下公式，方便以后查找使用。不写也可以。 公式类型：新建公式的时候就选了类型，如果想换类型，可以在这里重新选择。 画线方法：一般会用到副图、主图叠加这两个选项，副图就是在行情走势图下方的窗口显示，主图叠加就是叠加在行情走势图上。比如MACD就是在副图，MA均线就是主图叠加。 密码保护：可以给公式加密，并设定有效时限。 参数：参数可以设置一个范围，方便后续调整。比如默认是5日均线，后续可以调整成10日、20日、30日、60日均线等。 坐标线位置：默认是系统根据指标值自动设定区间，也可以手动设置。 额外Y轴分界：在指标上加上一些白色的横线。 上面的内容看起来挺多的，其实除了公式名称和画线方法，其他不设置都可以。 二、四类指标简介及使用方法 1、技术指标公式 技术指标就是通过一定的方法对一些行情数据进行计算，并把计算得到的结果以图表、曲线的形式输出到看盘界面上，方便寻找技术形态，掌握行情的变化情况。技术指标公式至少需要有1个输出，最多50个，输出包括文字、图标等。比如常见的VOL成交量、MA均线、MACD、KDJ等指标就是技术指标。 在主图上加载技术指标有两种方式 第一种，通达信K线图左上角，一个下拉按钮，点一下就可以选择主图指标； 第二种，在通达信K线图上，鼠标右键单击，就会出现菜单，鼠标移动到“主图指标”，然后点击“选择主图指标”。 在副图上加载指标，也是类似方法，不再赘述。一般通达信默认两个副图，只能查看两个指标。如果想新增指标，可以增加窗口。在K线图上右键单击，移动到“指标窗口个数”，选择想要的窗口数量。 2、条件选股公式 选股公式通过电脑运算寻找满足设定条件的技术形态，结合预警系统，可以在盘中实时提醒符合条件的股票。特别注意，条件选股公式只能有1个输出，这和技术指标不一样。 使用条件选股公式来选股，首先在通达信右上角找到“公式”——“条件选股”。有的版本可能不在这个位置，自行查找。 在条件选股窗口，首先选择“条件选股公式”，然后选择“加入条件”，再点击“执行选股”。当然还可以根据需求，设置其他条件。比如选股范围、计算参数、选股如板块等。 3、专家系统公式 专家系统公式可以辅助投资者建议一套属于自己的交易系统。专家系统公式可以加载在K线图上，会自动列出买卖信号。专家系统公式也可以用于程序交易评测系统和探索最佳专家系统，根据测试结果来更好的评估以及改进交易系统。专家系统公式输出只有买入点和卖出点，可以有1个或者2个输出。 在K线图上加载专家系统公式：在K线图上，右键单击，鼠标移动到“系统指示”，选择“专家系统指示”。 4、五彩K线公式 五彩K线公式可以加载到K线图上，通过各种颜色进行提示。五彩K线公式都只有1个输出。 在K线图上加载五彩K线公式：在K线图上，右键单击，鼠标移动到“系统指示”，选择“五彩K线指示”。 ","link":"https://blog.elex.vip/post/di-er-pian-tong-da-xin-zen-me-bian-xie-zhi-biao-gong-shi-yi-ji-tong-da-xin-gong-shi-de-shi-yong-fang-fa-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"第一篇——为什么要学编写通达信指标公式（从零起步编写通达信指标公式系列）","content":"内容提要：了解什么是指标公式以及为什么要学编写指标公式 一、什么是指标公式？ 指标公式是通达信、同花顺、大智慧等软件内置的一种公式编程语言，主要用于编写股票、期货市场的技术指标、选股公式、交易系统等功能。指标公式具有简单易学、功能强大、使用灵活等特点，它提供了丰富的函数和指标库，比如常见的MA均线、MACD、KDJ、RSI、BOLL等指标，以及常用的数学、逻辑、字符串等函数。投资者可以根据自己的需求和习惯来自定义变量和函数对其进行扩展，也可以用于实现自己的交易策略。 指标公式作用有如下几种： 技术指标画图： 通过对数据采取一定的运算，将技术指标输出结果直观的显现在分析图上，方便投资者研判行情 条件选股： 利用条件选股公式可以把符合一定技术形态的个股选出来，输出目标个股列表 交易系统： 用于指示买入点、卖出点。符合要求的指标公式，还可以用来进行回测 五彩k线：将满足条件的连续K线形态赋予颜色，区别于其它的K线颜色 有朋友估计想问了， 既然已经有了python，为什么还要了解指标公式？原因主要有： 通达信、同花顺、大智慧、东方财富、文华等众多软件都支持指标公式 网上有大量优秀的策略是用指标公式来实现的，了解后可以更加方便学习交流 相比python，指标公式会更简单直接很多，适合没有编程基础的朋友 一些量化系统也支持直接调用指标公式来进行量化交易，比如qmt等 为了方便用户使用，通达信、同花顺、大智慧、东方财富、文华等支持的指标公式都差不了多少， 下面以通达信公式为例进行说明。 通达信公式系统提供了很多可以在策略中调用的函数，其支持的函数分类包括行情函数、财务函数、计算函数、交易函数和其他函数几大类。 具体分类如下： 序列行情函数： 如HIGH/H表示最高价 即时行情函数：如DYNAINFO(28) 表示买一价 资金流向函数：如TRADENUM表示总成交单数 形态函数： 如COST(10)表示10%获利盘的价格是多少 板块函数： 如CODE返回品种代码 指数标的函数：如INDEXA表示大盘的成交额 专业财务函数：如FINVALUE表示专业财务数据(序列) 关联财务函数：如FINANCE(1)表示总股本（万股） 逻辑函数： 如CROSS(A，B) 表示当A从下方向上穿过B时返回1，否则返回0； 选择函数：如IF表示条件判断 数学函数： 如COS(X)返回X的余弦值，MAX表示求最大值 统计函数： 如STD(X，N)返回估算标准差 操作符函数： 如+、-、*等 交易信号函数：如BUY表示买入开仓 账号函数：如TOTALPOSITION表示总持仓 时间函数： 如DATE表示日期 引用函数： 如COUNT(X，N)表示统计满足条件的周期数； REF(X，A)表示引用A周期前的X值 绘图函数： 如DRAWKLINE 绘制K线 线形和颜色属性： 如COLORBLUE 画蓝色 指标公式示例 以均线多头排列指标公式为示例说明。均线多头排列是指从短周期到长周期均线，从上而下的依次排列，下面是代码实现，代码里面每行分号后面的是注释， 使用{ 我是注释 }来实现。 注意：同花顺公式注释方法不同，需要使用//注释 可以看出来，指标公式实现的均线多头排列是非常简单的。 执行后过一会就能看到选股结果了，点第一个结果进去看确实是均线连续4天多头排列，结果符合预期。 二、为什么要学编写通达信指标呢？ 编写通达信指标可以解决投资过程中的一些问题： 通达信自带的指标可能不能满足自己的要求，通过对指标进行改编，可以实现更多功能。比如加入颜色、醒目的提示甚至声音提醒等。 网上下载的指标或者复制的指标公式，只知道大概的功能，但是不知道指标的具体原理。学会了编写指标，可以读懂代码的逻辑，发现其中的是否存在漏洞或者错误，并可以吸收消化交易方法。 别人的指标公式不一定符合自己的交易理念、交易习惯，这样就不可能有效执行交易信号。可以通过学习消化，打造属于自己的指标体系。 学会了编写指标，可以把指标公式改写成选股公式。先粗选大体符合自己要求的股票，然后再人工分析，毕竟全市场四千多只股票，全部分析一遍会很耗时间。 可以对历史行情进行回测，通过分析收益、亏损、胜率、盈亏比等评测指标，评估指标是否有效。 通过编写通达信指标，能够加深对指标的认识，更好地利用指标。有些书上讲怎样根据指标信号买入卖出，但是却不讲指标背后的原理。单纯按照书上讲的方法来操作，可能结果不如人意。学会了编写指标，从指标的逻辑出发，可以更好的用来判断行情。 编写通达信指标难吗？ 编写通达信指标有一定的难度，但也不是非常难。为什么怎么说呢？因为通达信的编程语言很多函数都是封装好的，相当于模块化了。就像盖房子，如果让你用砖、水泥、沙子直接去砌墙盖房子，那难度太大了。不过现在有装配式建筑，墙板、阳台、预制板等都是在工厂造好了，运到工地就可以组装，这样难度就大大降低。通达信编写指标公式就相当于装配式建筑。 编写指标肯定需要花时间和精力去学习，并且通过一些练习掌握函数的使用方法，这样才能熟练使用。经常使用的函数也就三四十个，初期记不住，可以使用通达信自带的函数库，根据分类查找或者搜索使用。 四、举例 下面介绍两个简单的例子，看看编写指标可以实现哪些功能。为了方便展示，只以技术指标为例。作为初学者，下面的公式代码可能看不懂，先不管，后面会讲到的。 变色均线：60日均线向上的时候红色，拐头向下的时候变为绿色。 2. 变色K线：收盘价在60日均线上方时，画K线为阳线；收盘价在60日均线下方时，画K线为阴线。 其实变色K线有更简单的写法，那就是使用五彩K线公式。上面用技术指标写了五条语句，而五彩K线公式一句就可以解决。不过因为五彩K线公式只有1个输出，均线需要另外叠加技术指标。此外K线空心还是实心也有区别。 五彩K线公式变色K线代码： 五、最后说一句 其实编写指标不是最难的，难的是选股的思路、交易的方法，这关系到能不能盈利，不是轻轻松松就能学会的。 ","link":"https://blog.elex.vip/post/di-yi-pian-wei-shi-me-yao-xue-bian-xie-tong-da-xin-zhi-biao-gong-shi-cong-ling-qi-bu-bian-xie-tong-da-xin-zhi-biao-gong-shi-xi-lie/"},{"title":"MongoDB 命令小记","content":"查询当前MongoDB执行操作 ","link":"https://blog.elex.vip/post/mongodb-ming-ling-xiao-ji/"},{"title":"Linux CentOS/RHEL firewall-cmd常用命令","content":"启动CentOS/RHEL 7后，防火墙规则设置由firewalld服务进程默认管理。 一个叫做firewall-cmd的命令行客户端支持和这个守护进程通信以永久修改防火墙规则。 查看状态 查看防火墙所有信息 查看已经开放的端口 查看是否开放80端口 永久的开放一个新端口 [Port] 端口 移除端口 ","link":"https://blog.elex.vip/post/linux-centosrhel-firewall-cmd-chang-yong-ming-ling/"},{"title":"Docker 常用命令","content":"1. docker 基础命令 1.1. 启动docker命令 1.2. 关闭docker命令 1.3. 重启docker命令 1.4. 查看docker状态命令 1.5. 查看docker版本命令 1.6. 查看docker信息命令 1.7. docker 帮助命令 忘记了某些命令便可使用此进行查看与回顾 比如 咱忘记了 拉取命令 不知道可以带哪些参数 咱可以这样使用 2. docker 镜像命令 2.1. 查看自己服务器中docker 镜像列表 2.2. 搜索镜像 [MirrorName] 镜像名 搜索 STARS &gt;9000的 mysql 镜像 2.3. 拉取镜像 不加tag(版本号) 即拉取docker仓库中 该镜像的最新版本latest 加:tag 则是拉取指定版本 [MirrorName] 镜像名 [Tag] 版本号 2.4. 运行镜像 [MirrorName] 镜像名 [Tag] 版本号 2.5. 删除镜像 当前镜像没有被任何容器使用才可以删除 [MirrorName] 镜像名 [MirrorID] 镜像ID 2.5.1. 删除一个 2.5.2. 删除多个 其镜像ID或镜像用用空格隔开即可 2.5.3. 删除全部镜像 -a 意思为显示全部, -q 意思为只显示ID 2.6. 强制删除镜像 [MirrorName] 镜像名 [MirrorID] 镜像ID 2.7. 保存镜像 [MirrorName] 镜像名 [MirrorID] 镜像ID exmaple: 2.8. 加载镜像 任何装 docker 的地方加载镜像保存文件,使其恢复为一个镜像 [Path] 路径 [FileName] 文件名 3. docker 容器命令 3.1. 查看容器列表 3.1.1. 查看正在运行容器列表 3.1.2. 查看所有容器 包含正在运行 和已停止的 3.2. 构建容器 -it 表示 与容器进行交互式启动 -d 表示可后台运行容器 （守护式运行） --restart=always 容器自动重启 -v 宿主机文件存储位置:容器内文件位置 可同时挂载多个文件，须多个-v [HostFilePath] 宿主机文件存储位置 [ContainerFilePath] 容器内文件位置 --name 给要运行的容器 起的名字 [Alias] 容器别名 -p 宿主机端口:容器端口 [HostPort] 宿主机端口 [ContainerPort] 容器端口 [MirrorName] 镜像名 [MirrorID] 镜像ID /bin/bash 交互路径 3.3. 启动容器 [ContainerName] 容器名称 [ContainerID] 容器ID 3.4. 停止容器 [ContainerName] 容器名称 [ContainerID] 容器ID 3.5. 重启容器 [ContainerName] 容器名称 [ContainerID] 容器ID 3.6. 杀掉容器 [ContainerName] 容器名称 [ContainerID] 容器ID 3.7. 已有容器设置自动重启 [ContainerName] 容器名称 [ContainerID] 容器ID 3.8. 进入容器 [ContainerName] 容器名称 [ContainerID] 容器ID /bin/bash 交互路径 3.9. 容器文件拷贝 无论容器是否开启 都可以进行拷贝 [ContainerName] 容器名称 [ContainerID] 容器ID [ContainerPath] 容器内路径 [HostPath] 宿主机路径 3.9.1. 从容器内拷贝至宿主机 3.9.2. 从宿主机拷贝至容器内 3.10. 查看容器日志 [Line] 行数 要查看末尾多少行 默认all [ContainerName] 容器名称 [ContainerID] 容器ID 3.11. 更换容器名称 [ContainerName] 容器名称 [ContainerID] 容器ID [NewContainerName] 新容器名称 3.12. 查看容器进程 [ContainerName] 容器名称 [ContainerID] 容器ID 3.13. 查看容器信息 [ContainerName] 容器名称 [ContainerID] 容器ID 4. docker 进阶命令 4.1. 提交一个镜像 我们运行的容器可能在镜像的基础上做了一些修改，有时候我们希望保存起来，封装成一个更新的镜像，这时候我们就需要使用 commit 命令来构建一个新的镜像 -m 提交信息 [CommitInfo] 提交信息的内容 -m=&quot;初次提交&quot; -a 作者信息 [Author] 作者信息内容 -a=&quot;Elex&quot; [ContainerName] 容器名称 [ContainerID] 容器ID [MirrorName] 提交的镜像名称 [Tag] 镜像版本号 4.2. 打包一个镜像 -t 镜像名称:镜像版本号 [MirrorName] 打包的镜像名称 [Tag] 镜像版本号 . 当前目录 5. docker 运维命令 5.1. 查看docker工作目录 5.2. 查看docker磁盘占用总体情况 5.3. 查看docker的磁盘使用具体情况 5.4. 删除 无用的容器和 镜像 5.4.1. 删除异常停止的容器 5.4.2. 删除名称或标签为none的镜像 5.5. 清除所有无容器使用的镜像 5.6. 查找大文件 5.7. 查找指定docker使用目录下大于指定大小文件 [Path] 路径 目录 ","link":"https://blog.elex.vip/post/docker-chang-yong-ming-ling/"},{"title":"SpringBoot集成Quartz自定义表管理定时器","content":"前言 本文章中出现的第三方框架方法：MyBatis-Plus，Hutools，Quartz。 1. 建表 2. 导包 3. 添加配置文件 在resources下添加quartz.properties配置文件 4. 添加定时器工厂类 5. 添加定时器配置 6. 定时任务操作类 7. 定时任务实体 7.1. 任务操作类型枚举 7.1.1. 任务状态枚举 7.1.2. 任务状态枚举 7.1.3. 任务类型枚举 8. 定时任务操作接口 8.1. 定时任务操作接口类 8.2. 定时任务操作接口实现类 9. 启动初始化加载任务 ","link":"https://blog.elex.vip/post/springboot-ji-cheng-quartz-zi-ding-yi-biao-guan-li-ding-shi-qi/"},{"title":"java面试题之HashMap常见面试题总结","content":"“你用过HashMap吗？” “什么是HashMap？你为什么用到它？” 几乎每个人都会回答“是的”，然后回答HashMap的一些特性，譬如HashMap可以接受null键值和值，而Hashtable则不能；HashMap是非synchronized;HashMap很快；以及HashMap储存的是键值对等等。这显示出你已经用过HashMap，而且对它相当的熟悉。但是面试官来个急转直下，从此刻开始问出一些刁钻的问题，关于HashMap的更多基础的细节。面试官可能会问出下面的问题： “你知道HashMap的工作原理吗？” “你知道HashMap的get()方法的工作原理吗？” HashMap是基于hashing的原理，我们使用put(key, value)存储对象到HashMap中，使用get(key)从HashMap中获取对象。当我们给put()方法传递键和值时，我们先对键调用hashCode()方法，返回的hashCode用于找到bucket位置来储存Entry对象。”这里关键点在于指出，HashMap是在bucket中储存键对象和值对象，作为Map.Entry。这一点有助于理解获取对象的逻辑。如果你没有意识到这一点，或者错误的认为仅仅只在bucket中存储值的话，你将不会回答如何从HashMap中获取对象的逻辑。这个答案相当的正确，也显示出面试者确实知道hashing以及HashMap的工作原理。 “当两个对象的hashcode相同会发生什么？” 从这里开始，真正的困惑开始了，一些面试者会回答因为hashcode相同，所以两个对象是相等的，HashMap将会抛出异常，或者不会存储它们。然后面试官可能会提醒他们有equals()和hashCode()两个方法，并告诉他们两个对象就算hashcode相同，但是它们可能并不相等。一些面试者可能就此放弃，而另外一些还能继续挺进，他们回答“因为hashcode相同，所以它们的bucket位置相同，‘碰撞’会发生。因为HashMap使用链表存储对象，这个Entry(包含有键值对的Map.Entry对象)会存储在链表中。”这个答案非常的合理，虽然有很多种处理碰撞的方法，这种方法是最简单的，也正是HashMap的处理方法。但故事还没有完结，面试官会继续问： “如果两个键的hashcode相同，你如何获取值对象？” 面试者会回答：当我们调用get()方法，HashMap会使用键对象的hashcode找到bucket位置，然后获取值对象。面试官提醒他如果有两个值对象储存在同一个bucket，他给出答案:将会遍历链表直到找到值对象。面试官会问因为你并没有值对象去比较，你是如何确定确定找到值对象的？除非面试者直到HashMap在链表中存储的是键值对，否则他们不可能回答出这一题。其中一些记得这个重要知识点的面试者会说，找到bucket位置之后，会调用keys.equals()方法去找到链表中正确的节点，最终找到要找的值对象。完美的答案！许多情况下，面试者会在这个环节中出错，因为他们混淆了hashCode()和equals()方法。因为在此之前hashCode()屡屡出现，而equals()方法仅仅在获取值对象的时候才出现。一些优秀的开发者会指出使用不可变的、声明作final的对象，并且采用合适的equals()和hashCode()方法的话，将会减少碰撞的发生，提高效率。不可变性使得能够缓存不同键的hashcode，这将提高整个获取对象的速度，使用String，Interger这样的wrapper类作为键是非常好的选择。如果你认为到这里已经完结了，那么听到下面这个问题的时候，你会大吃一惊。 “如果HashMap的大小超过了负载因子(load factor)定义的容量，怎么办？” 除非你真正知道HashMap的工作原理，否则你将回答不出这道题。默认的负载因子大小为0.75，也就是说，当一个map填满了75%的bucket时候，和其它集合类(如ArrayList等)一样，将会创建原来HashMap大小的两倍的bucket数组，来重新调整map的大小，并将原来的对象放入新的bucket数组中。这个过程叫作rehashing，因为它调用hash方法找到新的bucket位置。如果你能够回答这道问题，下面的问题来了： “你了解重新调整HashMap大小存在什么问题吗？” 你可能回答不上来，这时面试官会提醒你当多线程的情况下，可能产生条件竞争(race condition)。当重新调整HashMap大小的时候，确实存在条件竞争，因为如果两个线程都发现HashMap需要重新调整大小了，它们会同时试着调整大小。在调整大小的过程中，存储在链表中的元素的次序会反过来，因为移动到新的bucket位置的时候，HashMap并不会将元素放在链表的尾部，而是放在头部，这是为了避免尾部遍历(tail traversing)。如果条件竞争发生了，那么就死循环了。这个时候，你可以质问面试官，为什么这么奇怪，要在多线程的环境下使用HashMap呢？：） “为什么String, Interger这样的wrapper类适合作为键？” String, Interger这样的wrapper类作为HashMap的键是再适合不过了，而且String最为常用。因为String是不可变的，也是final的，而且已经重写了equals()和hashCode()方法了。其他的wrapper类也有这个特点。不可变性是必要的，因为为了要计算hashCode()，就要防止键值改变，如果键值在放入时和获取时返回不同的hashcode的话，那么就不能从HashMap中找到你想要的对象。不可变性还有其他的优点如线程安全。如果你可以仅仅通过将某个field声明成final就能保证hashCode是不变的，那么请这么做吧。因为获取对象的时候要用到equals()和hashCode()方法，那么键对象正确的重写这两个方法是非常重要的。如果两个不相等的对象返回不同的hashcode的话，那么碰撞的几率就会小些，这样就能提高HashMap的性能。 “我们可以使用自定义的对象作为键吗？ ”这是前一个问题的延伸。当然你可能使用任何对象作为键，只要它遵守了equals()和hashCode()方法的定义规则，并且当对象插入到Map中之后将不会再改变了。如果这个自定义对象时不可变的，那么它已经满足了作为键的条件，因为当它创建之后就已经不能改变了。 “我们可以使用CocurrentHashMap来代替Hashtable吗？” 这是另外一个很热门的面试题，因为ConcurrentHashMap越来越多人用了。我们知道Hashtable是synchronized的，但是ConcurrentHashMap同步性能更好，因为它仅仅根据同步级别对map的一部分进行上锁。ConcurrentHashMap当然可以代替HashTable，但是HashTable提供更强的线程安全性。 这些问题设计哪些知识点： hashing的概念 HashMap中解决碰撞的方法 equals()和hashCode()的应用，以及它们在HashMap中的重要性 不可变对象的好处 HashMap多线程的条件竞争 重新调整HashMap的大小 “为什么HashMap中的键往往都使用String？” 1.hash（哈希，也称散列）算法：根据元素的hashCode值确定元 素的储存位置，从而快速定元素。相比于固定长度的数组，HashMap用hashCode值代替了索引值，使得HashMap的长度可 以自由增加。由于元素的hashCode值一般不会连续，所以元素的存储位置一般也不会连续，即随机存储 2.HashMap的内部实现是通过key的hashcode来确定value的存储位置。 3.HashMap是一种map，value应该由key唯一确定，key相同，value也应该相同，问题是，key的什么相同？值？地址？... 3.1首先想到的是String对象的值，它不就很像字典中的索引。 3.1.1恰巧，首先，String是不可变的，且重写了hashCode(),这使得，即使两个字符串对象的引用不同，但只要值相同，它们的hashcode就相同，就可以索引到相同的value，直接满足我们HashMap中hash和map的要求。 3.1.2其次，每当创建一个字符串对象时，它的hashcode 就被缓存下来，所以在HashMap种储存时不需要再次计算,相比于其他对象更快。 3.2如果key的地址（即对象的引用）呢？ 3.2.1首先，使用没有重写hashCode（）的对象作key，这使得，只要两个对象的引用不同，它们的hashcode值就不同，想要索引出value，就必须使用储存该value时的key对象，相对于使用key的值，这样会更加严格。 3.2.2其次，对象中一般不会存储该对象的hashCode值，在HashMap中储存时就得需要重新计算 现在看来，仿佛冥冥之中，String与HashMap的相遇是注定的 总结 HashMap的工作原理HashMap基于hashing原理，我们通过put()和get()方法储存和获取对象。当我们将键值对传递给put()方法时，它调用键对象的hashCode()方法来计算hashcode，让后找到bucket位置来储存值对象。当获取对象时，通过键对象的equals()方法找到正确的键值对，然后返回值对象。HashMap使用链表来解决碰撞问题，当发生碰撞了，对象将会储存在链表的下一个节点中。 HashMap在每个链表节点中储存键值对对象。当两个不同的键对象的hashcode相同时会发生什么？ 它们会储存在同一个bucket位置的链表中。键对象的equals()方法用来找到键值对。因为HashMap的好处非常多，在电子商务的应用中使用HashMap作为缓存。因为金融领域非常多的运用Java，也出于性能的考虑，我们会经常用到HashMap和ConcurrentHashMap。你可以查看更多的关于HashMap的文章: ","link":"https://blog.elex.vip/post/java-mian-shi-ti-zhi-hashmap-chang-jian-mian-shi-ti-zong-jie/"},{"title":"BigDecimal Postman 返回正常精度前端接收不正常（前后端交互丢失精度）","content":" 前后端交互BigDecimal类型字段丢失精度 例如 解决方案 注解解释 (BigDecimal Postman 返回正常精度前端接收不正常（前后端交互丢失精度）) 前后端交互BigDecimal类型字段丢失精度 例如 postman 的返回： 例如 前端接收 的返回： 实体类里的字段类型： 例如 该字段的值为 “ 12345671234567.12345”，到前端就变成了 “12345671234567.123”，前端要求保留所有小数。 解决方案 在需要转化的字段上添加 @JsonFormat(shape = JsonFormat.Shape.STRING) 注解 注解解释 @JsonFormat 用来表示json序列化的一种格式或者类型，shap表示序列化后的一种类型 ","link":"https://blog.elex.vip/post/bigdecimal-postman-fan-hui-zheng-chang-jing-du-qian-duan-jie-shou-bu-zheng-chang-qian-hou-duan-jiao-hu-diu-shi-jing-du/"},{"title":"Java-Poi 指定列单元格式","content":" POI导出设置某列值为文本格式 HSSFWorkbook方式 XSSFWorkbook方式 ( Java-Poi 指定列单元格式) POI导出设置某列值为文本格式 HSSFWorkbook方式 XSSFWorkbook方式 poi的jar包版本：3.10 ","link":"https://blog.elex.vip/post/java-poi-zhi-ding-lie-dan-yuan-ge-shi/"},{"title":"Sql Server + Mybatis-plus使用Page时报错","content":" “OFFSET”附近有语法错误 代码实现 错误信息 解决过程 定位问题 解决方案 (Sql Server + Mybatis-plus使用Page时报错：) “OFFSET”附近有语法错误 最近开发遇到的问题，SqlServer+Mybatis-Plus Page插件进行分页时的报错 代码实现 Maven依赖 Mapper.xml 错误信息 解决过程 定位问题 找到报错的sql 控制显示的一句异常信息 进入com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor.java,在concatOrderBy打上断点 在执行该句代码时异常： 在控制台debug监视CCJSqlParserUtil.parse(originalSql)，直接抛出异常，是sql语句的问题 解决方案 去掉mapper.xml中sql的中括号 去掉后成功运行，CCJSqlParserUtil.parse(originalSql)不报错。 ","link":"https://blog.elex.vip/post/sql-server-mybatis-plus-shi-yong-page-shi-bao-cuo/"},{"title":"一个对象中有很多属性，假如有个属性不想在日志中打印，其他属性都打印","content":" 问题由来 解决方案 Lombok主要常用的注解有： 说明 (一个对象中有很多属性，假如有个属性不想在日志中打印，其他属性都打印) 问题由来 最近朋友在群里提了这么一个问题，另外一个朋友回了一句重写toString()? 这确实是一个方法，不过不太方便！ 解决方案 这个问题，记得在一次机缘巧合之下在一篇讲lombok工具包的时候，有提到过。 @ToString(exclude=&quot;column&quot;) 意义：排除column列所对应的元素，即在生成toString方法时不包含column参数； @ToString(exclude={&quot;column1&quot;,&quot;column2&quot;}) 意义：排除多个column列所对应的元素，其中间用英文状态下的逗号进行分割，即在生成toString方法时不包含多个column参数； @ToString(of=&quot;column&quot;) 意义：只生成包含column列所对应的元素的参数的toString方法，即在生成toString方法时只包含column参数；； @ToString(of={&quot;column1&quot;,&quot;column2&quot;}) 意义：只生成包含多个column列所对应的元素的参数的toString方法，其中间用英文状态下的逗号进行分割，即在生成toString方法时只包含多个column参数； 下面继续普及下lombok所有注解的说明，顺带巩固下自己的记忆 Lombok主要常用的注解有： @Data,@getter,@setter,@NoArgsConstructor,@AllArgsConstructor,@ToString,@EqualsAndHashCode,@Slf4j,@Log4j。我们一个一个来看： 说明 注解 说明 @Data 在JavaBean或类JavaBean中使用，这个注解包含范围最广，它包含getter、setter、NoArgsConstructor、equals、canEqual、hashCode、toString 注解，即当使用当前注解时，会自动生成包含的所有方法； @getter 在JavaBean或类JavaBean中使用，使用此注解会生成对应的getter方法； @setter 在JavaBean或类JavaBean中使用，使用此注解会生成对应的setter方法； @NoArgsConstructor 在JavaBean或类JavaBean中使用，使用此注解会生成对应的无参构造方法； @AllArgsConstructor 在JavaBean或类JavaBean中使用，使用此注解会生成对应的有参构造方法； @ToString 在JavaBean或类JavaBean中使用，使用此注解会自动重写对应的toStirng方法； @EqualsAndHashCode 在JavaBean或类JavaBean中使用，使用此注解会自动重写对应的equals方法和hashCode方法； @Slf4j 在需要打印日志的类中使用，当项目中使用了slf4j打印日志框架时使用该注解，会简化日志的打印流程，只需调用info方法即可； @Log4j 在需要打印日志的类中使用，当项目中使用了log4j打印日志框架时使用该注解，会简化日志的打印流程，只需调用info方法即可； ","link":"https://blog.elex.vip/post/yi-ge-dui-xiang-zhong-you-hen-duo-shu-xing-jia-ru-you-ge-shu-xing-bu-xiang-zai-ri-zhi-zhong-da-yin-qi-ta-shu-xing-du-da-yin/"},{"title":"docker 安装Jenkins自动部署SpringBoot项目及所遇到的问题集合","content":"docker安装Jenkins场景： 安装了以下服务 jdk1.8（非docker容器安装） maven3.6.3 （非docker容器安装） docker nginx（docker容器部署） mysql（docker容器部署） redis（docker容器部署） 开始安装Jenkins： 启动docker，通过docker下载Jenkins镜像文件 创建Jenkins挂载目录并授权权限（我们在服务器上先创建一个jenkins工作目录 /var/jenkins_mount，赋予相应权限，稍后我们将jenkins容器目录挂载到这个目录上，这样我们就可以很方便地对容器内的配置文件进行修改。 如果我们不这样做，那么如果需要修改容器配置文件，将会有点麻烦，因为虽然我们可以使用docker exec -it --user root 容器id /bin/bash 命令进入容器目录，但是连简单的 vi命令都不能使用） 创建并启动Jenkins容器 -d 后台运行镜像 -p 8081:8081 将镜像的8081端口映射到服务器的8081端口（后面服务部署用到的端口。docker容器部署，需要把部署项目的端口映射出来） -p 10240:8080 将镜像的8080端口映射到服务器的10240端口 -p 10241:50000 将镜像的50000端口映射到服务器的10241端口 -v /var/jenkins_mount:/var/jenkins_mount /var/jenkins_home目录为容器jenkins工作目录，我们将硬盘上的一个目录挂载到这个位置，方便后续更新镜像后继续使用原来的工作目录。这里我们设置的就是上面我们创建的 /var/jenkins_mount目录 -v /etc/localtime:/etc/localtime 让容器使用和服务器同样的时间设置 -v /usr/java/default:/opt/java/openjdk 让容器可以使用服务器的jdk -v /usr/local/apache-maven-3.6.3:/usr/local/maven 让容器可以使用服务器的Maven -v /home/shiyue-ticket/logs/:/home/shiyue-ticket/logs/ 将项目的日志目录挂载道到本地硬盘 -v root 给容器root的权限 --name jenkins 给容器起一个别名 查看jenkins是否启动成功，如下图出现端口号，就为启动成功了 查看docker容器日志 配置镜像加速，进入/var/jenkins_mount/目录 **修改hudson.model.UpdateCenter.xml里的内容 修改前** 将 url 修改为 清华大学官方镜像：https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json 修改后 访问Jenkins页面，输入你的ip加上10240 入门 管理员密码获取方法，查看initialAdminPassword文件，把密码输入登录中的密码即可，开始使用。 到此就全部安装完成了 安装Git，GitLab插件： 后期更新 问题： 后期更新 ","link":"https://blog.elex.vip/post/docker-an-zhuang-jenkins-zi-dong-bu-shu-springboot-xiang-mu-ji-suo-yu-dao-de-wen-ti-ji-he/"}]}